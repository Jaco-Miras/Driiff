(this.webpackJsonpdriff=this.webpackJsonpdriff||[]).push([[17],{870:function(n,e,t){"use strict";t.r(e);var r=t(9),i=t(1),a=t(107),o=t(136),s=t(184),l=t(183),c=t(5),p=t(0),u=t.n(p),d=t(780),h=t(6),f=t(43),m=t(4),g=t(12),b=t(7),x=(t(382),t(11)),y=t(802),w=t(803),v=t(804);function A(){var n=Object(c.a)(["\n  padding: ",";\n  font-weight: 500;\n  color: #929496;\n  &.important {\n    font-weight: 600;\n    color: #191c20;\n  }\n  @media (max-width: 620px) {\n    display: block;\n    font-size: 11px;\n    line-height: 1.2;\n  }\n"]);return A=function(){return n},n}function C(){var n=Object(c.a)(["\n  color: #aab0c8;\n  font-style: italic;\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n  position: absolute;\n  top: calc(50% - 25px);\n  margin: 0 10px;\n  ",";\n  height: 25px;\n  white-space: nowrap;\n\n  svg {\n    width: 15px;\n    height: 15px;\n    position: relative;\n    top: 2px;\n    margin-right: 5px;\n  }\n"]);return C=function(){return n},n}function O(){var n=Object(c.a)(["\n  color: #676767;\n  display: flex;\n  flex-flow: ",";\n  .reply-date {\n    margin: ",";\n    flex-flow: column;\n    justify-content: center;\n  }\n  .reply-date.updated {\n    > span:last-child {\n      display: none;\n    }\n  }\n  .reply-date.updated:hover {\n    > span:first-child {\n      display: none;\n    }\n    > span:last-child {\n      display: block;\n    }\n  }\n  .msg-fail {\n    color: red;\n  }\n"]);return O=function(){return n},n}function _(){var n=Object(c.a)(["\n  ","\n\n  .reply-author {\n    ",";\n  }\n  .reply-content {\n    clear: both;\n    width: 100%;\n    display: block;\n    z-index: 1;\n\n    p {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n\n      a {\n        color: ",";\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n\n        @media only screen and (max-width: 1024px) {\n          white-space: normal;\n          word-break: break-word;\n\n          &:hover {\n            word-break: unset;\n          }\n        }\n\n        &:hover {\n          overflow: unset;\n          white-space: unset;\n          text-overflow: unset;\n          word-break: break-word;\n        }\n      }\n    }\n  }\n  .gif_player {\n    clear: both;\n    position: relative;\n    left: 0;\n    overflow: hidden;\n    //height: 250px;\n    min-height: 150px;\n    cursor: pointer;\n    .gifPlayer {\n      border-radius: 8px;\n      max-height: 250px;\n    }\n    .play_button {\n      height: 60px;\n      width: 60px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n  }\n"]);return _=function(){return n},n}function E(){var n=Object(c.a)(["\n  display: flex;\n  flex-flow: ",";\n\n  .chat-content {\n    width: 100%;\n    padding-left: 0;\n  }\n\n  .chat-clap {\n    float: ",";\n  }\n"]);return E=function(){return n},n}function k(){var n=Object(c.a)(["\n  max-width: ",";\n  padding: ",";\n  // // max-width: ",";\n  // padding: ",";\n  ul {\n    list-style-type: none;\n  }\n\n  a {\n    cursor: pointer;\n    color: ",";\n    //color: ",";\n    text-decoration: underline;\n\n    // &.gdrive-link {\n    //   text-decoration: none;\n\n    //   .link {\n    //     @media (max-width: 1580px) {\n    //       max-width: 20vw;\n    //     }\n    //     @media (max-width: 1480px) {\n    //       max-width: 14vw;\n    //     }\n    //     @media (max-width: 1380px) {\n    //       max-width: 5vw;\n    //     }\n    //     @media (max-width: 991.99px) {\n    //       max-width: 350px;\n    //     }\n    //     @media (max-width: 822px) {\n    //       max-width: 20vw;\n    //     }\n    //   }\n    //   .preview-text {\n    //     font-weight: bold;\n    //     color: ",";\n    //   }\n    // }\n\n    &:focus,\n    &:hover {\n      color: ",";\n    }\n    &.btn {\n      border: 1px solid ",";\n\n      &:focus,\n      &:hover {\n        border: 1px solid ",";\n      }\n\n      &.btn-action {\n        margin-top: 0.5rem;\n        border-radius: 8px;\n      }\n\n      &.btn-complete {\n        color: ",";\n        border: 1px solid ",";\n      }\n    }\n  }\n\n  span.completed {\n    text-decoration: line-through;\n  }\n"]);return k=function(){return n},n}function j(){var n=Object(c.a)(["\n  color: ",";\n  max-width: 100%;\n  img,\n  video {\n    display: none;\n  }\n  .video-quote,\n  .image-quote {\n    img {\n      width: auto;\n      display: inline-block;\n    }\n  }\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: pre-wrap;\n  a {\n    color: ",";\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n\n    @media only screen and (max-width: 1024px) {\n      white-space: normal;\n      word-break: break-word;\n\n      &:hover {\n        word-break: unset;\n      }\n    }\n\n    &:hover {\n      overflow: unset;\n      white-space: unset;\n      text-overflow: unset;\n      word-break: break-word;\n    }\n  }\n"]);return j=function(){return n},n}function M(){var n=Object(c.a)(["\n  font-weight: 600;\n  @media all and (max-width: 620px) {\n    font-size: 11px;\n    line-height: 1.2;\n    font-weight: normal;\n  }\n"]);return M=function(){return n},n}function N(){var n=Object(c.a)(["\n  background: ",";\n  border-radius: 6px;\n  margin: 4px -4px 4px -4px;\n  text-align: left;\n  padding: 10px 10px 10px 20px;\n  position: relative;\n  cursor: pointer;\n  max-width: ",";\n  &:before {\n    height: 70%;\n    width: 5px;\n    background: ",";\n    background: #ffffffe6;\n    position: absolute;\n    ",";\n    display: inline-block;\n    float: left;\n    left: 5px;\n    opacity: 0.8;\n    @media all and (max-width: 620px) {\n      display: none;\n    }\n  }\n  @media all and (max-width: 620px) {\n    margin: 7px -7px 10px -7px;\n    padding: 7px;\n  }\n"]);return N=function(){return n},n}function R(){var n=Object(c.a)(["\n  position: relative;\n  display: inline-flex;\n  flex-flow: column;\n  padding: ",";\n  border-radius: 6px;\n  background: ",";\n  text-align: left;\n  width: 100%;\n  color: ",";\n  font-size: 0.835rem;\n  overflow: visible;\n  min-height: ",";\n\n  &:after {\n    border: 10px solid #0000;\n    position: absolute;\n    top: 6px;\n    z-index: 1;\n    ",";\n    border-left-color: ",";\n    border-right-color: ",";\n    height: 5px;\n  }\n\n  // a:not([href]):not([tabindex]) {\n  //   color: ",";\n\n  //   &:hover {\n  //     color: ",";\n  //   }\n  // }\n\n  video {\n    width: 100%;\n  }\n  p.reply-author {\n    color: ",";\n    font-weight: 400;\n    font-size: 12px;\n    font-style: italic;\n    margin: 0;\n    display: block;\n    position: absolute;\n    top: -24px;\n    left: 0;\n    white-space: nowrap;\n    ","\n  }\n  span.emoticon-body {\n    font-size: 2.5rem;\n    padding: 20px 10px;\n    text-align: ",";\n  }\n  .reply-content img {\n    max-width: 100%;\n    max-height: 300px;\n  }\n  span.reply-date {\n    color: ",";\n    font-style: italic;\n    font-size: 11px;\n    position: absolute;\n    top: 0;\n    ",";\n    display: flex;\n    height: 100%;\n    text-align: ",";\n    white-space: nowrap;\n  }\n  ol {\n    text-align: left;\n    position: relative;\n    padding-inline-start: 0;\n    li {\n      margin-left: 0;\n    }\n  }\n  ul {\n    li {\n      text-align: left;\n      position: relative;\n      margin-left: 0;\n    }\n  }\n  span.is-deleted {\n    font-style: italic;\n    color: ",";\n  }\n  span.image-uploading {\n    display: none;\n  }\n  .chat-file-notification {\n    b:hover {\n      text-decoration: underline;\n      cursor: pointer;\n    }\n  }\n  a.a_fancy {\n    border-radius: 5px !important;\n    background-color: #fff !important;\n    box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.11) !important;\n    text-decoration: none !important;\n    display: inline-block;\n    height: auto !important;\n    padding: 5px 10px;\n    margin-bottom: 5px;\n    color: #000 !important;\n    font-family: Inter !important;\n    font-size: 13px !important;\n    letter-spacing: 0 !important;\n    line-height: 21px !important;\n    margin-right: 1pt;\n    margin-left: 1pt;\n  }\n  .message-files div:first-child {\n    align-items: ",";\n  }\n"]);return R=function(){return n},n}var F=m.b.div(R(),(function(n){return n.hasFiles?"3px":"6px 9px 8px 9px"}),(function(n){return n.isAuthor?n.theme.colors.primary:"#F0F0F0"}),(function(n){return n.isAuthor?"#ffffff":"#000000"}),(function(n){return n.hasGif?"150px":"33px"}),(function(n){return n.isAuthor?"right: -16px":"left: -15px"}),(function(n){return n.isAuthor?"#7A1B8B":"#0000"}),(function(n){return n.isAuthor?"#0000":"#F0F0F0"}),(function(n){return n.isAuthor?"#ffffff":"#8C3B9B"}),(function(n){return n.isAuthor?"#fff":"#0056b3"}),(function(n){return n.isAuthor?"#ffffff":"#AAB0C8"}),(function(n){return!0===n.isForwardedMessage&&"top: -40px;"}),(function(n){return n.isAuthor?"right":"left"}),(function(n){return n.showAvatar&&!1===n.hideBg||n.hasRemoveOnDlFiles||n.showAvatar&&n.hasFiles?"#a7abc3":"#0000"}),(function(n){return n.isAuthor?"right: 100%":"left: 100%"}),(function(n){return n.isAuthor?"right":"left"}),(function(n){return n.isAuthor?"#ffffffe6":"#AAB0C8"}),(function(n){return n.isAuthor?"flex-end":"flex-start"})),B=m.b.div(N(),(function(n){return n.isAuthor?"#8C3B9B":"#E4E4E4"}),(function(n){return n.hasFiles?"210px":"auto"}),(function(n){return n.isAuthor?"#8C3B9B":"#E4E4E4"}),(function(n){return!n.isEmoticonOnly&&"content: ''"})),L=m.b.div(M()),S=m.b.div(j(),(function(n){return n.isAuthor?"#ffffffe6":"#000000"}),(function(n){return n.isAuthor?"#ffffffe6":"#8C3B9B"})),T=m.b.span(k(),(function(n){return n.hasFiles?"200px":"auto"}),(function(n){return n.hasFiles?"7px 4px 5px 6px":"0"}),(function(n){return n.hasFiles?"200px":"auto"}),(function(n){return n.hasFiles?"0px 3px":"0"}),(function(n){return n.isAuthor?"#ffffff":n.theme.colors.primary}),(function(n){return n.isAuthor?"#ffffff99":"#7a1b8b"}),(function(n){return n.isAuthor?"#FFF":"#828282"}),(function(n){return n.isAuthor?"#ffffff":"#7a1b8b"}),(function(n){return n.isAuthor?"#ffffff":"#8C3B9B"}),(function(n){return n.isAuthor?"#fff":"#0056b3"}),(function(n){return n.isAuthor?"#fff":"#0056b3"}),(function(n){return n.isAuthor?"#fff":"#0056b3"})),I=m.b.div(E(),(function(n){return n.isAuthor?"row":"row-reverse"}),(function(n){return n.isAuthor?"left":"right"})),D=m.b.div(_(),(function(n){return!n.isEmoticonOnly&&"\n    &:before {\n        ".concat((function(n){return n.showAvatar&&"content: ''"}),";\n        border: 10px solid transparent;\n        border-left-color: #f0f0f0;\n        position: absolute;\n        top: 6px;\n        left: -15px;\n        z-index: 1;\n        ").concat((function(n){return!0===n.isAuthor&&"\n            left: auto;\n            right: -15px;\n            border-left-color: red;\n            border-left-color: #7A1B8B;\n            border-right-color: transparent;\n        "}),";\n        width: 20px;\n        height: 20px;\n    }\n    ")}),(function(n){return n.isAuthor?"margin-left: 30px":"margin-right: 30px"}),(function(n){return n.isAuthor,"#ff4444"})),z=m.b.div(O(),(function(n){return n.isAuthor?"row":"row-reverse"}),(function(n){return n.isAuthor?"0 10px 0 0":"0 0 0 10px"})),P=m.b.span(C(),(function(n){return n.isAuthor?"right: 100%;":"left: 100%;"})),q=m.b.span(A(),(function(n){return n.isEmoticonOnly||n.isGifOnly||!0===n.hasFiles?"3px 9px 3px 9px":"0"})),H=[.1,.2,.3,.4,.5,.6,.7,.8,.9],U=u.a.memo((function(n){var e=n.reply,t=n.showAvatar,r=n.selectedChannel,i=n.showGifPlayer,a=n.isAuthor,o=n.addMessageRef,s=n.user,l=n.isLastChat,c=n.chatMessageActions,h=n.timeFormat,m=(n.chatSettings,n.dictionary),A=n.users,C=n.translated_channels,O=n.chat_language,_=n.translate,E=n.language,k=n.loadReplies,j=Object(f.g)();Object(v.a)({message:e,actions:c}),Object(w.a)({message:e,isAuthor:a,translate:r.is_translate,chat_language:O,actions:c});var M=Object(x.d)({reply:e,dictionary:m,isAuthor:a,user:s,selectedChannel:r,users:A,translate:_,language:E,translated_channels:C,chat_language:O}),N=M.quoteAuthor,R=M.quoteBody,U=M.replyBody,V=M.hasMessage,G=M.isGifOnly,Y=M.isEmoticonOnly,Z=e.files.length>0,W=e.files.some((function(n){return n.remove_on_download})),J={container:Object(p.useRef)(null),replyRef:Object(p.useRef)(null)},K=Object(p.useRef)(null),Q=Object(d.b)({threshold:1}),X=Object(b.a)(Q,2),$=X[0],nn=X[1],en=Object(d.b)({threshold:H,skip:!l}),tn=Object(b.a)(en,3),rn=tn[0],an=tn[1],on=tn[2],sn=function(n){return n.preventDefault(),j.push(n.currentTarget.dataset.href),!1};Object(p.useEffect)((function(){var n=J.container.current.querySelector("a.push");return n&&n.addEventListener("click",sn,!0),function(){n&&n.removeEventListener("click",sn,!0)}}),[]),Object(p.useEffect)((function(){"object"===typeof j.location.state&&j.location.state&&j.location.state.focusOn===e.code&&J.container.current&&K.current&&(J.container.current.scrollIntoView({block:"center"}),K.current&&K.current.classList.add("pulse"),j.push(j.location.pathname,null))}),[j.location.state,J.container.current,K.current]),Object(p.useEffect)((function(){o&&nn&&k&&k()}),[o,nn,k]),Object(p.useEffect)((function(){l&&on&&(on.boundingClientRect.height-on.intersectionRect.height>=16?c.setLastMessageVisiblility({status:!1}):c.setLastMessageVisiblility({status:!0}))}),[l,on,an]);var ln=e.user&&A[e.user.id]&&"external"===A[e.user.id].type&&!a;return u.a.createElement(F,{ref:J.container,tabIndex:e.id,hasFiles:Z,className:"chat-bubble ql-editor ".concat(e.is_important&&"important"," ").concat(ln&&"external-chat"),showAvatar:t,isAuthor:a,hideBg:Y||G||Z&&!V,hasGif:i,hasRemoveOnDlFiles:W},u.a.createElement(u.a.Fragment,null,e.is_transferred&&u.a.createElement(P,{className:"small",isAuthor:a},u.a.createElement(g.s,{icon:"corner-up-right"}),m.forwardedMessage),u.a.createElement(I,{ref:o?$:null,className:"chat-content-clap",isAuthor:a},u.a.createElement(D,{showAvatar:t,isAuthor:a,isEmoticonOnly:Y,className:"chat-content animated slower",ref:K},!a&&t&&u.a.createElement(u.a.Fragment,null,u.a.createElement(q,{isEmoticonOnly:Y,hasFiles:Z,isGifOnly:G,className:"chat-name-not-author-mobile ".concat(e.is_important&&"important")},"BOT"===e.user.type&&e.user.code&&e.user.code.includes("huddle")?e.user.name.substr(0,e.user.name.length/2):e.user.name)),e.quote&&e.quote.hasOwnProperty("body")&&!e.is_deleted&&(void 0!==e.quote.user_id||void 0!==e.quote.user)&&u.a.createElement(B,{className:"quote-container",showAvatar:t,isEmoticonOnly:Y,hasFiles:Z,onClick:function(n){if(e.quote){var t=document.querySelector(".chat-list-item-".concat(e.quote.id));t&&t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},isAuthor:a},e.quote.user_id===s.id?u.a.createElement(L,{isAuthor:!0},"You"):u.a.createElement(L,{isAuthor:e.quote.user_id===s.id},N),u.a.createElement(S,{className:"quote-content",isAuthor:a,dangerouslySetInnerHTML:{__html:R}})),V&&u.a.createElement("span",{ref:l?rn:null},u.a.createElement(T,{ref:J.replyRef,hasFiles:Z,isAuthor:a,className:"reply-content ".concat(Y?"emoticon-body":""," ").concat(e.is_deleted?"is-deleted":""," ").concat(e.body.startsWith("ZOOM_MESSAGE::{")?"zoom-msg":""),dangerouslySetInnerHTML:{__html:U}})),e.files.length>0&&!e.is_deleted&&u.a.createElement(y.a,{dictionary:m,isAuthor:a,files:e.files,type:"chat",topic_id:"TOPIC"===r.type?r.entity_id:null}),i&&u.a.createElement(g.c,{body:e.body,autoplay:!0}))),u.a.createElement(z,{className:"chat-timestamp",isAuthor:a},u.a.createElement("span",{className:"reply-date created"},isNaN(e.id)&&"failed"===e.status&&u.a.createElement("span",{className:"msg-fail"},m.messageFailed),!isNaN(e.id)&&u.a.createElement("span",null,h.todayOrYesterdayDate(e.created_at.timestamp)),W&&u.a.createElement("span",null,m.removeOnDownload)))))})),V=t(805),G=t(806),Y=t(807),Z=t(818),W=t(808),J=t(15);function K(){var n=Object(c.a)(["\n  color: #a7abc3;\n  font-style: italic;\n  font-size: 11px;\n  position: absolute;\n  top: 0;\n  left: calc(100% + 10px);\n  display: flex;\n  height: 100%;\n  align-items: center;\n  white-space: nowrap;\n"]);return K=function(){return n},n}function Q(){var n=Object(c.a)(["\n  display: block;\n  width: 100%;\n  cursor: ",";\n  strong {\n    cursor: ",";\n  }\n"]);return Q=function(){return n},n}function X(){var n=Object(c.a)(['\n  display: block;\n  width: 100%;\n\n  .chat-file-notification {\n    b:hover {\n      text-decoration: underline;\n      cursor: pointer;\n    }\n  }\n\n  .push-link {\n    display: inline-block;\n    position: relative;\n    padding-bottom: 25px;\n    margin-bottom: -25px;\n    width: 100%;\n\n    &:before {\n      position: absolute;\n      left: -14px;\n      top: -7px;\n      bottom: 0;\n      width: 6px;\n      height: calc(100% - 12px);\n      background: linear-gradient(180deg, rgba(106, 36, 126, 1) 0%, rgba(216, 64, 113, 1) 100%);\n      content: "";\n      border-radius: 6px 0 0 6px;\n    }\n\n    .card-body {\n      margin-top: 0.5rem;\n      margin-bottom: 0.5rem;\n      padding: 1rem;\n      max-width: 95%;\n      display: block;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      font-size: 12px;\n    }\n\n    .open-post {\n      display: flex;\n      position: absolute;\n      right: -20px;\n      bottom: -10px;\n      justify-content: center;\n      align-items: center;\n      font-size: 12px;\n\n      svg {\n        margin-left: 0;\n        height: 12px;\n      }\n    }\n  }\n']);return X=function(){return n},n}var $=m.b.span(X()),nn=m.b.span(Q(),(function(n){return n.isPostNotification?"pointer":"auto"}),(function(n){return n.isZoomMessage?"pointer":"auto"})),en=m.b.div(K()),tn=[.1,.2,.3,.4,.5,.6,.7,.8,.9],rn=u.a.memo((function(n){var e=n.reply,t=n.selectedChannel,r=n.isLastChat,i=n.chatMessageActions,a=n.user,o=n.timeFormat,s=n.dictionary,l=Object(x.yb)(),c=Object(p.useRef)(),h=Object(f.g)(),m=Object(f.i)(),g=Object(p.useRef)(!0),y=Object(p.useState)(!1),w=Object(b.a)(y,2),v=w[0],A=w[1],C=Object(x.Y)({dictionary:s,reply:e,selectedChannel:t,user:a}).parseBody,O=Object(d.b)({threshold:tn,skip:!r}),_=Object(b.a)(O,3),E=_[0],k=_[1],j=_[2];Object(p.useEffect)((function(){r&&j&&(j.boundingClientRect.height-j.intersectionRect.height>=16?i.setLastMessageVisiblility({status:!1}):i.setLastMessageVisiblility({status:!0}))}),[r,j,k]);var M=function(n){if(n.preventDefault(),e.body.startsWith("ZOOM_MEETING::{")&&!v){A(!0);var r=JSON.parse(e.body.replace("ZOOM_MEETING::","")),i={meetingNumber:r.meetingNumber,role:0,password:r.password,channel_id:t.id};l.generateSignature(i,(function(){g.current&&A(!1)}))}return!1};Object(p.useEffect)((function(){var n=null;return e.body.startsWith("ZOOM_MEETING::{")&&(n=c.current.querySelector("strong"))&&n.addEventListener("click",M,!0),function(){n&&n.removeEventListener("click",M,!0)}}),[]);return u.a.createElement($,{ref:r?E:null},u.a.createElement(nn,{id:"bot-".concat(e.id),onClick:function(){if(e.body.startsWith("UPLOAD_BULK::")){var n=JSON.parse(e.body.replace("UPLOAD_BULK::",""));n.files&&i.viewFiles(n.files)}else if(e.body.startsWith("POST_CREATE::")){if(""!==e.body.replace("POST_CREATE::","").trim()){var t=JSON.parse(e.body.replace("POST_CREATE::",""));m&&m.workspaceId?m.folderId?h.push("/workspace/posts/".concat(m.folderId,"/").concat(m.folderName,"/").concat(m.workspaceId,"/").concat(Object(J.h)(m.workspaceName),"/post/").concat(t.post.id,"/").concat(Object(J.h)(t.post.title))):h.push("/workspace/posts/".concat(m.workspaceId,"/").concat(m.workspaceName,"/post/").concat(t.post.id,"/").concat(Object(J.h)(t.post.title))):h.push("/posts/".concat(t.post.id,"/").concat(Object(J.h)(t.post.title)))}}},ref:c,dangerouslySetInnerHTML:{__html:C},isPostNotification:e.body.includes("POST_CREATE::"),isZoomMessage:e.body.includes("ZOOM_MEETING::")}),u.a.createElement(en,{className:"chat-timestamp",isAuthor:!1},u.a.createElement("span",{className:"reply-date created"},o.todayOrYesterdayDate(e.created_at.timestamp))))})),an=t(108),on=t(16),sn=t(70),ln=u.a.memo((function(n){var e=n.replyData,t=n.className,r=void 0===t?"":t,i=n.selectedChannel,a=n.dictionary,o=n.width,s=void 0===o?250:o,l=n.scrollComponent,c=Object(h.c)(),p=Object(x.bb)();return u.a.createElement(sn.c,{width:s,className:r,scrollRef:l},u.a.createElement("div",{onClick:function(){c(Object(on.hb)(e.payload,(function(n,e){n&&p.error(a.errorSendingChat)})))}},a.resend),u.a.createElement("div",{onClick:function(){c(Object(on.Cb)({id:e.id,channel_id:i.id}))}},a.delete))}));function cn(){var n=Object(c.a)(["\n  display: flex;\n  -webkit-box-align: center;\n  align-items: center;\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  svg {\n    max-width: 100%;\n    width: 100%;\n    max-height: 40%;\n    margin: auto;\n  }\n"]);return cn=function(){return n},n}function pn(){var n=Object(c.a)(["\n  align-self: flex-start;\n  width: 2rem !important;\n  height: 2rem !important;\n  margin-top: ",";\n\n  img {\n    width: 2rem !important;\n    height: 2rem !important;\n  }\n  @media (max-width: 620px) {\n    display: none;\n  }\n  .pixel-avatar {\n    padding-top: 2px !important;\n  }\n"]);return pn=function(){return n},n}function un(){var n=Object(c.a)(["\n  width: 100%;\n  ul {\n    margin: 0;\n  }\n"]);return un=function(){return n},n}function dn(){var n=Object(c.a)(["\n  display: flex;\n  justify-content: center;\n  &.initial-load {\n    position: absolute;\n    top: 45%;\n    left: 45%;\n    transform: translate(-45%, -45%);\n  }\n"]);return dn=function(){return n},n}function hn(){var n=Object(c.a)(["\n  position: relative;\n  display: inline-flex;\n  border-radius: 8px;\n  background: #f4f4f4f4;\n  text-align: left;\n  min-width: 100px;\n  max-width: 100%;\n  padding: 7px 15px;\n  line-height: 1.5rem;\n  float: left;\n  align-items: center;\n  justify-content: flex-end;\n  flex-flow: ",";\n  .chat-options {\n    visibility: hidden;\n  }\n  :hover {\n    .chat-options {\n      visibility: visible;\n    }\n  }\n  @media (max-width: 620px) {\n    padding: 7px;\n  }\n"]);return hn=function(){return n},n}function fn(){var n=Object(c.a)(["\n  //width: 100%;\n  //overflow: hidden;\n  max-width: 75%;\n  position: relative;\n  flex-flow: column;\n  display: inherit;\n  margin-left: ",";\n  > img {\n    max-height: 300px;\n    max-width: 100%;\n    width: auto;\n    object-fit: cover;\n  }\n  .edited-message {\n    color: #aab0c8;\n    font-style: italic;\n    display: flex;\n    align-items: center;\n    font-size: 12px;\n    position: absolute;\n    top: 50%;\n    margin: 0 10px;\n    height: 25px;\n    white-space: nowrap;\n    ",";\n  }\n  .chat-options {\n    visibility: hidden;\n  }\n  .chat-options.active {\n    visibility: visible;\n  }\n  :hover {\n    .chat-options {\n      visibility: visible;\n    }\n  }\n  @media (max-width: 991.99px) {\n    max-width: calc(100% - 110px);\n  }\n\n  @media (max-width: 620px) {\n    ",";\n    ",";\n  }\n"]);return fn=function(){return n},n}function mn(){var n=Object(c.a)(["\n  flex-flow: ",";\n  flex-wrap: wrap;\n  ",";\n  min-width: 150px;\n  color: #a7abc3;\n  background: #ffffff;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  top: 0;\n  ",";\n  height: calc(100% + 4px);\n  margin-top: -2px;\n  transition: opacity 0.3s ease;\n  button {\n    margin: 5px;\n  }\n"]);return mn=function(){return n},n}function gn(){var n=Object(c.a)(["\n  flex-flow: ",";\n  flex-wrap: wrap;\n  ",";\n  min-width: 150px;\n  color: #a7abc3;\n  background: #ffffff;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  top: 0;\n  ",";\n  height: ",";\n  margin-top: -2px;\n  transition: opacity 0.3s ease;\n"]);return gn=function(){return n},n}function bn(){var n=Object(c.a)(["\n  display: flex;\n  width: 100%;\n  align-items: center;\n  justify-content: flex-end;\n  flex-flow: column;\n  flex-flow: ",";\n  margin-left: ",";\n  ",";\n  margin-top: ",";\n  margin-top: ",";\n  @media (max-width: 620px) {\n    margin-top: ",";\n    margin-top: ",";\n    ",";\n    ",";\n    ",";\n  }\n  &:before {\n    ",";\n    border: 10px solid transparent;\n    border-right-color: ",";\n    position: absolute;\n    top: ",";\n    left: 30px;\n    z-index: 1;\n    @media all and (max-width: 620px) {\n      display: none;\n    }\n    ",";\n  }\n  // .more-options:hover {\n  //   border: 1px solid #972c86 !important;\n  //   svg {\n  //     color: #972c86;\n  //   }\n  // }\n  .dark & {\n    &:before {\n      display: none;\n    }\n  }\n"]);return bn=function(){return n},n}function xn(){var n=Object(c.a)(["\n  z-index: 2;\n  color: #a7abc3;\n  display: inline-block;\n  left: 50%;\n  position: sticky;\n  top: 10px;\n  transform: translateX(-50%);\n  span {\n    padding: 4px 8px;\n    display: inline-block;\n    font-size: 11px;\n    border-radius: 6px;\n    margin: 0 4px;\n    background: #f0f0f0;\n  }\n  &[stuck] {\n    &:before,\n    &:after {\n      display: none;\n    }\n  }\n"]);return xn=function(){return n},n}function yn(){var n=Object(c.a)(["\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  margin-bottom: ",";\n  text-align: center;\n  .chat-actions-container {\n    opacity: 0;\n  }\n\n  &:hover {\n    .chat-actions-container {\n      opacity: 1;\n    }\n  }\n  &.pulsating div.chat-bubble {\n    animation: blinker 2s linear forwards;\n    @keyframes blinker {\n      50% {\n        opacity: 0.5;\n      }\n    }\n  }\n"]);return yn=function(){return n},n}function wn(){var n=Object(c.a)(["\n  background: transparent;\n  background-repeat: repeat;\n  height: calc(100% - 125px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  -webkit-overflow-scrolling: touch;\n  //z-index: 1;\n  scrollbar-width: none;\n  > ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n  .chat-message-options svg {\n    fill: currentColor;\n  }\n  .chat-message-options {\n    display: flex;\n    flex-direction: column;\n    flex-basis: 100%;\n    flex: 1;\n    margin: 5px;\n    max-width: 25px;\n\n    @media (max-width: 620px) {\n      margin-right: 0;\n    }\n\n    .more-options-tooltip {\n      &.orientation-bottom {\n        top: calc(100% - 35px);\n        @media (max-width: 620px) {\n          top: 100%;\n        }\n      }\n\n      &.orientation-top {\n        @media (max-width: 620px) {\n          bottom: 30px;\n        }\n      }\n\n      &.orientation-right {\n        left: calc(100% + 10px);\n        @media (max-width: 620px) {\n          left: 0;\n        }\n      }\n      &.orientation-left {\n        @media (max-width: 620px) {\n          left: auto;\n          right: 0;\n        }\n      }\n    }\n  }\n  &.is-processed {\n    opacity: 0;\n  }\n"]);return wn=function(){return n},n}var vn=m.b.div(wn()),An=m.b.li(yn(),(function(n){return n.isLastChat?"20px":"5px"})),Cn=m.b.div(xn()),On=m.b.div(bn(),(function(n){return n.isAuthor?"row":"row-reverse"}),(function(n){return n.isAuthor||n.showAvatar?"0":"22px"}),(function(n){return!0===n.isAuthor&&"position: relative; right: 15px;"}),(function(n){return n.showAvatar&&"36px"}),(function(n){return n.showAvatar&&n.isAuthor&&"20px"}),(function(n){return n.showAvatar&&"12px"}),(function(n){return n.showAvatar&&n.isAuthor&&"8px"}),(function(n){return!n.showAvatar&&!n.isAuthor&&!n.isBot&&"margin-left: 0"}),(function(n){return!0===n.isAuthor&&!n.showAvatar&&"position: relative; right: 0px;"}),(function(n){return!0===n.isAuthor&&"position: relative; right: 0px;"}),(function(n){return n.showAvatar&&"content: '';"}),(function(n){return n.isImportant?"#7B68EE":n.isExternalChat?"#FFDB92":"#f0f0f0"}),(function(n){return n.showAvatar&&!n.isAuthor?"42px":"6px"}),(function(n){return!0===n.isAuthor&&"\n            left: auto;\n            right: -16px;\n            border-left-color:  ".concat((function(n){return n.isImportant?"#7B68EE":"#7A1B8B"}),";\n            border-right-color: transparent;\n            @media all and (max-width: 620px) {\n              display: none;\n            }\n        ")})),_n=m.b.div(gn(),(function(n){return n.isAuthor?"row-reverse":"row"}),(function(n){return n.isAuthor?"margin-right: 10px":"margin-left: 10px"}),(function(n){return n.isAuthor?"right: 100%":"left: 100%"}),(function(n){return n.hasReactions?"calc(100% - 20px)":"calc(100% + 4px)"})),En=m.b.div(mn(),(function(n){return n.isAuthor?"row-reverse":"row"}),(function(n){return n.isAuthor?"margin-right: 10px":"margin-left: 10px"}),(function(n){return n.isAuthor?"right: 100%":"left: 100%"})),kn=m.b.div(fn(),(function(n){return n.showAvatar&&!n.isAuthor?"1rem":"1.6rem"}),(function(n){return n.isAuthor?"right: 100%;":"left: 100%"}),(function(n){return!n.showAvatar&&!n.isAuthor&&"margin-left: 0"}),(function(n){return!0===!n.isAuthor&&"margin-left: 0"})),jn=m.b.div(hn(),(function(n){return n.isAuthor?"row":"row-reverse"})),Mn=m.b.div(dn()),Nn=m.b.div(un()),Rn=Object(m.b)(g.a)(pn(),(function(n){return!0===n.isForwardedMessage?"25px":"0"})),Fn=m.b.div(cn()),Bn=function(n){Object(s.a)(t,n);var e=Object(l.a)(t);function t(n){var r;return Object(a.a)(this,t),(r=e.call(this,n)).loadReplies=function(){var n=r.props,e=n.selectedChannel,t=n.chatMessageActions,i=r.scrollComponent.current;if(!e.isFetching&&e.hasMore){t.channelActions.fetchingMessages(e,!0);var a={skip:0,limit:20};"undefined"!==typeof e.replies&&(a={skip:0===e.skip&&e.replies.length?e.replies.length:e.skip,limit:20}),t.fetch(e,a,(function(n,a){if(n)t.channelActions.fetchingMessages(e,!1);else if((0===e.replies.length||0===e.skip)&&"object"!==typeof r.props.history.location.state){i.scrollTop=i.scrollHeight;var o=i.scrollHeight;setTimeout((function(){o<i.scrollHeight&&(i.scrollTop=i.scrollHeight)}),1e3)}}))}},r.handleReadChannel=function(){if(r.props.unreadCount>0||r.props.selectedChannel.total_unread>0){var n=r.props,e=n.selectedChannel;n.chatMessageActions.channelActions.markAsRead(e)}},r.handleResendMessage=function(n){r.props.createChatMessageV2Action(n,(function(e,t){e&&r.props.onFailedMessageSend(n)}))},r.handleRemoveReply=function(n){r.props.cbOnRemoveReply(n)},r.handleEditReply=function(n){r.props.onEditReply(n)},r.handleQuoteReply=function(n){r.props.onSelectQuote(n)},r.handleLoadMoreRefChange=function(n,e){n&&r.loadReplies()},r.handleShowSeenUsers=function(){return r.setState({showSeenUsers:!r.state.showSeenUsers})},r.filterSeenMembers=function(){return r.props.selectedChannel.members.filter((function(n){return 2===r.props.selectedChannel.members.length?!(!r.props.selectedChannel.last_reply||!r.props.selectedChannel.last_reply.user)&&(r.props.selectedChannel.last_reply.user.id===r.props.user.id?!(r.props.user.id===n.id):!(r.props.selectedChannel.last_reply.user.id===n.id)):(!r.props.selectedChannel.last_reply||!r.props.selectedChannel.last_reply.user||r.props.selectedChannel.last_reply.user.id!==n.id)&&r.props.user.id!==n.id})).filter((function(n){return!!n.last_visited_at&&n.last_visited_at.timestamp>=r.props.selectedChannel.last_reply.created_at.timestamp}))},r.getLoadRef=function(n){var e=r.props.selectedChannel,t=!1;if(e.replies.length&&!e.isFetching){var i=e.replies.findIndex((function(e){return e.id===n}));i<Math.round(e.replies.length/2)&&i%2===0&&(t=!0)}return t},r.gMessages=Object(an.a)((function(n){return Object.entries(n.sort((function(n,e){return n.created_at.timestamp-e.created_at.timestamp===0?n.id-e.id:n.created_at.timestamp-e.created_at.timestamp})).map((function(n,e){return n.hasOwnProperty("g_date")?Object(i.a)(Object(i.a)({},n),{},{isLastChat:e===r.props.selectedChannel.replies.length-1}):Object(i.a)(Object(i.a)({},n),{},{g_date:r.props.timeFormat.localizeDate(n.created_at.timestamp,"YYYY-MM-DD"),isLastChat:e===r.props.selectedChannel.replies.length-1})})).reduce((function(n,e){var t=e.g_date;return n[t]=n[t]||[],n[t].push(e),n}),{}))})),r.state={},r.scrollComponent=u.a.createRef(),r}return Object(o.a)(t,[{key:"componentWillUnmount",value:function(){var n=this.scrollComponent.current;this.props.chatMessageActions.channelActions.saveHistoricalPosition(this.props.selectedChannel.id,n)}},{key:"componentDidMount",value:function(){var n=this.props,e=n.selectedChannel,t=n.historicalPositions,r=this.scrollComponent.current;"object"!==typeof this.props.history.location.state&&(t.length?t.forEach((function(n){n.channel_id===e.id&&r&&(r.scrollTop=r.scrollHeight-n.scrollPosition)})):r&&(r.scrollTop=r.scrollHeight)),e.hasMore&&0===e.skip&&this.loadReplies(),e.is_read&&this.handleReadChannel()}},{key:"getSnapshotBeforeUpdate",value:function(n,e){var t=this.props.selectedChannel,r=this.scrollComponent.current;return n.selectedChannel&&n.selectedChannel&&n.selectedChannel.replies&&t.replies&&r&&t.replies.length>20&n.selectedChannel.replies.length<t.replies.length&&t.replies.length-n.selectedChannel.replies.length>=2?r.scrollHeight-r.scrollTop:null}},{key:"componentDidUpdate",value:function(n,e,t){var r=this.props,i=r.selectedChannel,a=r.historicalPositions,o=this.scrollComponent.current;this.props.selectedChannel&&n.selectedChannel.id!==i.id&&(i.hasMore&&0===i.skip&&this.loadReplies(),this.handleReadChannel(),a.length&&a.forEach((function(n){n.channel_id===i.id&&o&&(o.scrollTop=o.scrollHeight-n.scrollPosition)}))),i&&n.selectedChannel.id===this.props.selectedChannel.id&&(null!==t&&i.replies.length!==n.selectedChannel.replies.length&&(i.replies.length-n.selectedChannel.replies.length===1?i.last_reply&&i.last_reply.user&&i.last_reply.user.id!==this.props.user.id&&(this.props.isLastChatVisible||(o.scrollTop=o.scrollHeight-t)):o.scrollTop=o.scrollHeight-t),i.replies&&i.replies.length&&i.replies.length-n.selectedChannel.replies.length===1&&(i.last_reply&&i.last_reply.user&&i.last_reply.user.id===this.props.user.id?o&&(o.scrollTop=o.scrollHeight):this.props.isLastChatVisible&&!this.props.isIdle&&this.props.isBrowserActive&&document.hasFocus()&&(i.is_read&&this.props.chatMessageActions.channelActions.markAsRead(i),o&&(o.scrollTop=o.scrollHeight)))),this.props.unreadCount>0&&this.props.isLastChatVisible&&!this.props.isIdle&&this.props.isBrowserActive&&document.hasFocus()&&this.handleReadChannel()}},{key:"render",value:function(){var n=this,e=0,t=this.gMessages(this.props.selectedChannel.replies);return u.a.createElement(vn,{ref:this.scrollComponent,id:"component-chat-thread",className:"component-chat-thread messages ".concat(this.props.className),tabIndex:"2"},this.props.selectedChannel.isFetching&&this.props.selectedChannel.hasMore&&0===this.props.selectedChannel.replies.length&&0===this.props.selectedChannel.skip&&u.a.createElement(Mn,{className:"initial-load"},u.a.createElement(g.j,null)),u.a.createElement(Nn,{className:"infinite-scroll",id:"infinite-scroll-chat-replies"},this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length>=20&&u.a.createElement(d.a,{as:"div",onChange:function(e,t){return n.handleLoadMoreRefChange(e,t)}},u.a.createElement("span",{className:"intersection-load-more-ref"})),u.a.createElement("ul",null,this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length?t.map((function(t,i){return u.a.createElement("div",{key:"".concat(t[0])},u.a.createElement(Cn,{className:"timestamp-container"},u.a.createElement("span",null,n.props.timeFormat.localizeChatDate(t[1][0].created_at.timestamp,"ddd, MMM DD, YYYY"))),t[1].map((function(t,i,a){var o=t.user&&t.user.id===n.props.user.id,s=!1,l=!1,c=!1,p=!1,d=!1,h=!1,f=[];if(t.user){if(t.created_at.timestamp&&(0===i&&(l=!0,s=!0),0!==i&&n.props.timeFormat.localizeDate(a[i-1].created_at.timestamp,"D")!==n.props.timeFormat.localizeDate(t.created_at.timestamp,"D")&&(l=!0,s=!0),0!==i&&t.created_at.timestamp-a[i-1].created_at.timestamp>600&&(s=!0)),0!==i&&!0===a[i-1].is_read&&!1===t.is_read&&(d=!0),0!==i&&null===a[i-1].user&&(s=!0),e!==t.user.id&&(s=!0,e=t.user.id),"undefined"!==typeof t.body&&null!==t.body&&null!==t.body.match(J.b)&&(c=!0),t.files&&t.files.length>0&&a[i+1]&&a[i+1].user&&a[i+1].user.id===t.user.id&&a[i-1]&&0===a[i-1].files.length||s&&t.files&&t.files.length>0){h=!0;var m=a[i+1]?a[i+1].files:[];f=[].concat(Object(r.a)(t.files),Object(r.a)(m));for(var g=2;a[i+g]&&(!a[i+g].user||a[i+g].user.id===t.user.id);)f=[].concat(Object(r.a)(f),Object(r.a)(a[i+g].files)),g++}p=["gripp_bot_account","gripp_bot_invoice","gripp_bot_offerte","gripp_bot_project","gripp_bot_account","driff_webhook_bot","huddle_bot"].includes(t.user.code)}return u.a.createElement(An,{key:t.id,className:"chat-list chat-list-item-".concat(t.id," code-").concat(t.code),showTimestamp:l,isLastChat:t.isLastChat},t.user&&d&&n.props.unreadCount>0&&u.a.createElement(G.a,null),t.user&&u.a.createElement(On,{isAuthor:o,className:"chat-reply-list-item chat-reply-list-item-".concat(t.id," ").concat(o?"chat-right":"chat-left"),showAvatar:s,isBot:p,isImportant:t.is_important,isExternalChat:t.user&&n.props.users[t.user.id]&&"external"===n.props.users[t.user.id].type&&!o},u.a.createElement(kn,{isAuthor:o,showAvatar:s,className:"chat-bubble-quote-div"},u.a.createElement(U,{chatMessageActions:n.props.chatMessageActions,timeFormat:n.props.timeFormat,user:n.props.user,reply:t,showAvatar:s,selectedChannel:n.props.selectedChannel,showGifPlayer:c,isAuthor:o,addMessageRef:n.getLoadRef(t.id),isLastChat:t.isLastChat,loadReplies:n.loadReplies,chatSettings:n.props.settings,dictionary:n.props.dictionary,users:n.props.users,translate:n.props.translate,language:n.props.language,translated_channels:n.props.translated_channels,chat_language:n.props.chat_language}),u.a.createElement(_n,{isAuthor:o,className:"chat-actions-container ".concat(t.reactions.length&&"has-reactions"),hasReactions:t.reactions.length},!isNaN(t.id)&&u.a.createElement(Y.a,{isAuthor:o,reply:t,scrollComponent:n.scrollComponent.current,chatMessageActions:n.props.chatMessageActions}),!isNaN(t.id)&&!t.is_deleted&&u.a.createElement(V.a,{dictionary:n.props.dictionary,className:"chat-message-options",selectedChannel:n.props.selectedChannel,scrollComponent:n.scrollComponent.current,isAuthor:o,replyData:t,teamChannelId:n.props.teamChannelId,isExternalUser:"external"===n.props.user.type,chatMessageActions:n.props.chatMessageActions,showDownloadAll:h,downloadFiles:f}),isNaN(t.id)&&"failed"===t.status&&u.a.createElement(ln,{dictionary:n.props.dictionary,className:"chat-message-options",selectedChannel:n.props.selectedChannel,scrollComponent:n.scrollComponent.current,replyData:t})),t.reactions.length>0&&u.a.createElement(Z.a,{reactions:t.reactions,isAuthor:o,reply:t,loggedUser:n.props.user,chatReactionAction:n.props.chatReactionV2Action}),n.props.selectedChannel.last_reply&&n.props.selectedChannel.last_reply.id===t.id&&n.filterSeenMembers().length>0&&u.a.createElement(W.a,{isAuthor:o,onClick:n.handleShowSeenUsers,seenMembers:n.filterSeenMembers(),isPersonal:2===n.props.selectedChannel.members.length})),!o&&s&&u.a.createElement(Rn,{isForwardedMessage:t.is_transferred,id:t.user.id,type:"USER",imageLink:t.user.profile_image_thumbnail_link?t.user.profile_image_thumbnail_link:t.user.profile_image_link,name:t.user.name,isBot:p,isHuddleBot:"huddle_bot"===t.user.code,showSlider:!0})),null===t.user&&u.a.createElement(On,{className:"chat-reply-list-item system-reply-list-item chat-reply-list-item-".concat(t.id),isAuthor:!1},u.a.createElement(kn,{isAuthor:o,showAvatar:s,className:"chat-bubble-quote-div"},u.a.createElement(jn,{className:"system-message",isAuthor:!1},u.a.createElement(rn,{user:n.props.user,chatMessageActions:n.props.chatMessageActions,timeFormat:n.props.timeFormat,selectedChannel:n.props.selectedChannel,reply:t,isLastChat:t.isLastChat,dictionary:n.props.dictionary,users:n.props.users}),u.a.createElement(En,{isAuthor:o,className:"chat-actions-container"},u.a.createElement(Y.a,{isAuthor:o,reply:t,scrollComponent:n.scrollComponent.current,chatMessageActions:n.props.chatMessageActions}),!isNaN(t.id)&&!t.is_deleted&&u.a.createElement(V.a,{dictionary:n.props.dictionary,scrollComponent:n.scrollComponent.current,replyData:t,className:"chat-message-options",selectedChannel:n.props.selectedChannel,isAuthor:o,teamChannelId:n.props.teamChannelId,isExternalUser:"external"===n.props.user.type,chatMessageActions:n.props.chatMessageActions}))),t.reactions.length>0&&u.a.createElement(Z.a,{reactions:t.reactions,reply:t,isAuthor:!1,loggedUser:n.props.user,chatReactionAction:n.props.chatReactionV2Action}))))})))})):null,!this.props.selectedChannel.isFetching&&this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length<1&&u.a.createElement(Fn,{className:"no-reply-container"},u.a.createElement(g.q,{icon:3})))))}}]),t}(u.a.PureComponent);e.default=Object(f.k)(Object(h.b)((function(n){var e=n.global,t=e.isIdle,r=e.isBrowserActive,i=n.session.user,a=n.chat,o=a.historicalPositions,s=a.isLastChatVisible,l=a.selectedChannel,c=n.users.users;return{user:i,settings:n.settings.user.CHAT_SETTINGS,historicalPositions:o,isLastChatVisible:s,users:c,isIdle:t,isBrowserActive:r,selectedChannel:l}}),null)(Bn))}}]);