(this.webpackJsonpdriff=this.webpackJsonpdriff||[]).push([[13],{638:function(e,n,t){"use strict";var i=t(0),a=t(11),r=t(1),s=t.n(r),o=t(5),l=t(14),c=t(196),p=t(198),u=t(138);n.a=s.a.memo((function(e){var n=e.isAuthor,t=e.replyData,d=e.className,h=void 0===d?"":d,m=e.selectedChannel,f=e.dictionary,g=e.width,b=void 0===g?250:g,x=e.teamChannelId,v=void 0===x?null:x,y=e.isExternalUser,w=Object(r.useState)(!1),_=Object(a.a)(w,2),C=_[0],A=_[1],j=Object(o.c)(),E=document.getElementById("component-chat-thread"),O=Object(c.a)(),k=Object(p.a)(),M=k.selectUserChannel,R=k.loggedUser,N=k.users,S=k.channels,L=k.history,T=k.match;Object(r.useEffect)((function(){t.user&&"BOT"===t.user.type&&t.body.includes("<div><p>Your")&&!t.hasOwnProperty("huddle_log")&&O.channelActions.fetchUnpublishedAnswers({channel_id:t.channel_id})}),[]);var I=function(){O.remove(t.id)};var F=t.user&&N[t.user.id]&&"internal"===N[t.user.id].type,B=t.files.some((function(e){return"trashed"===e.file_type}));return s.a.createElement(u.c,{width:b,className:h,scrollRef:E},!t.hasOwnProperty("huddle_log")&&s.a.createElement("div",{onClick:function(){return O.remind(t,m)}},f.remindMeAboutThis),n&&t.hasOwnProperty("is_transferred")&&!t.is_transferred&&s.a.createElement("div",{onClick:function(){var e=t,n=e.body,i=document.createElement("div");i.innerHTML=n;for(var a=i.getElementsByClassName("fancied");a[0];)a[0].parentNode.removeChild(a[0]);var r=i.innerHTML;e.body=r.replace(/(<a [^>]*(href="([^>^\"]*)")[^>]*>)((?:.(?!\<\/a\>))*.)(<\/a>)/g,(function(e,n,t,i,a,r,s){return i})),O.setEdit(e)}},f.edit),!t.hasOwnProperty("huddle_log")&&s.a.createElement("div",{onClick:function(){O.setQuote(t)}},f.quote),n&&s.a.createElement("div",{onClick:function(){var e={type:"confirmation",headerText:f.removeChat,submitText:f.remove,cancelText:f.cancel,bodyText:f.removeThisChat,actions:{onSubmit:I}};j(Object(l.a)(e))}},f.remove),!t.hasOwnProperty("huddle_log")&&s.a.createElement("div",{onClick:function(){O.clipboardLink(m,t)}},f.copyMessageLink),!t.hasOwnProperty("huddle_log")&&!B&&s.a.createElement("div",{onClick:function(){var e={type:"forward",channel:m,message:t};j(Object(l.a)(e))}},f.forward),n&&s.a.createElement("div",{onClick:function(){return O.markImportant(t)}},t.is_important?f.unMarkImportant:f.markImportant),t.user&&t.user.code&&t.user.code.includes("huddle_bot")&&t.body.includes("<div><p>Your Unpublished")&&s.a.createElement("div",{onClick:function(){O.setHuddleAnswers({id:t.id,channel_id:t.channel_id,huddle_log:t.huddle_log})}},"Edit huddle"),t.body.startsWith("HUDDLE_SKIP::")&&s.a.createElement("div",{onClick:function(){O.addSkip({channel_id:t.channel_id,id:t.id})}},"Unskip"),t.user&&"BOT"!==t.user.type&&t.user.id!==R.id&&"DIRECT"!==m.type&&t.user.code&&"huddle_bot"!==t.user.code&&F&&s.a.createElement("div",{onClick:function(){if(!C){A(!0),M(t.user,(function(e){e&&e.id&&O.setQuote(Object(i.a)(Object(i.a)({},t),{},{channel_id:e.id})),A(!1)}))}}},f.replyInPrivate),v&&!y&&s.a.createElement("div",{onClick:function(){if(!C){var e=function(e){if(e&&e.id){O.setQuote(Object(i.a)(Object(i.a)({},t),{},{channel_id:e.id}));var n=T.url;"/chat/:code"===T.path?L.push("/chat/".concat(v.code)):T.path.startsWith("/workspace/chat")&&L.push(n.replace("/workspace/chat","/workspace/team-chat"))}A(!1)};A(!0),S[v]?O.channelActions.select(S[v.id],e):O.channelActions.fetchByCode(v.code,(function(n,t){n||(e(t.data),O.channelActions.select(Object(i.a)(Object(i.a)({},t.data),{},{selected:!0,hasMore:!1,isFetching:!1,skip:0,replies:[]})))}))}}},"Discuss on team chat"))}))},639:function(e,n,t){"use strict";var i=t(9),a=t(1),r=t.n(a),s=t(10);function o(){var e=Object(i.a)(['\n  .sepline {\n    font-weight: 600;\n    font-size: 0.85em;\n    color: #972c86;\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 100%;\n    max-width: 100%;\n    margin: 10px auto 8px;\n    &::before,\n    &::after {\n      content: "";\n      position: absolute;\n      background-color: #972c86;\n      width: 100%;\n      height: 1px;\n      display: block;\n      clear: both;\n\n      @media only screen and (min-width: 1800px) {\n        max-width: 44%;\n      }\n\n      @media only screen and (max-width: 1799px) {\n        max-width: 42%;\n      }\n\n      @media only screen and (max-width: 1650px) {\n        max-width: 40%;\n      }\n\n      @media only screen and (max-width: 1440px) {\n        max-width: 38%;\n      }\n\n      @media only screen and (max-width: 1360px) {\n        max-width: 36%;\n      }\n\n      @media only screen and (max-width: 1280px) {\n        max-width: 40%;\n      }\n\n      @media only screen and (max-width: 1136px) {\n        max-width: 32%;\n      }\n\n      @media only screen and (max-width: 1080px) {\n        max-width: 30%;\n      }\n\n      @media only screen and (max-width: 1024px) {\n        max-width: 26%;\n      }\n\n      @media only screen and (max-width: 1000px) {\n        max-width: 24%;\n      }\n\n      @media only screen and (max-width: 996px) {\n        max-width: 20%;\n      }\n\n      @media only screen and (max-width: 640px) {\n        max-width: 35%;\n      }\n    }\n    &::before {\n      left: 0;\n    }\n    &::after {\n      right: 0;\n    }\n  }\n']);return o=function(){return e},e}function l(){var e=Object(i.a)(["\n  &.hide {\n    visibility: hidden;\n    opacity: 0;\n  }\n"]);return l=function(){return e},e}var c=s.a.div(l()),p=s.a.div(o());n.a=function(e){return r.a.createElement(c,{className:"new-message-sepline"},r.a.createElement(p,null,r.a.createElement("span",{className:"sepline"},"New Message/s")))}},640:function(e,n,t){"use strict";var i=t(11),a=t(9),r=t(1),s=t.n(r),o=t(10),l=t(19),c=t(12),p=t(196);function u(){var e=Object(a.a)(['\n  &.orientation-top {\n    bottom: 25px;\n  }\n  &.orientation-bottom {\n    top: calc(100% + 5px);\n  }\n  &.orientation-left {\n    right: calc(100% - 25px);\n    left: auto;\n  }\n  &.orientation-right {\n    left: calc(100% - 25px);\n    right: auto;\n  }\n\n  @media (max-width: 576px) {\n    position: fixed;\n    justify-content: center;\n    display: flex;\n\n    &.orientation-top {\n      bottom: 100px;\n    }\n    &.orientation-bottom {\n      top: auto;\n      bottom: 100px;\n    }\n    &.orientation-left {\n      right: 0;\n      left: 0;\n    }\n    &.orientation-right {\n      left: 0;\n      right: 0;\n    }\n  }\n\n  .emoji-mart-bar {\n    display: none;\n  }\n\n  li {\n    &:before {\n      content: "" !important;\n      margin: 0 !important;\n      display: none !important;\n    }\n\n    padding-left: 0 !important;\n    text-align: left !important;\n    position: relative !important;\n    margin-left: 10px !important;\n  }\n']);return u=function(){return e},e}function d(){var e=Object(a.a)(["\n  @media (max-width: 620px) {\n    //display: none;\n  }\n  ",";\n\n  &:hover {\n    filter: brightness(0) saturate(100%) invert(23%) sepia(21%) saturate(6038%) hue-rotate(284deg) brightness(93%) contrast(91%);\n  }\n"]);return d=function(){return e},e}function h(){var e=Object(a.a)(["\n  border-radius: 50%;\n  width: 26px;\n  height: 26px;\n  padding: 0;\n  cursor: pointer;\n  position: relative;\n  @media (max-width: 620px) {\n    width: 20px;\n    height: 20px;\n  }\n"]);return h=function(){return e},e}var m=o.a.div(h()),f=Object(o.a)(l.s)(d(),(function(e){return e.active&&"filter: brightness(0) saturate(100%) invert(23%) sepia(21%) saturate(6038%) hue-rotate(284deg) brightness(93%) contrast(91%);"})),g=Object(o.a)(l.l)(u());n.a=function(e){var n=e.reply,t=e.showEmojiSwitcher,a=void 0===t?null:t,o=null,l=Object(p.a)(),u=document.getElementById("component-chat-thread"),d={container:Object(r.useRef)(null),picker:Object(r.useRef)(null)},h=Object(r.useState)(a),b=Object(i.a)(h,2),x=b[0],v=b[1],y=function(){return v(!x)},w=Object(c.ab)(d.container,d.picker,u,x).orientation;return Object(r.useEffect)((function(){null!==a&&v(!0)}),[a]),Object(c.F)(d.container,(function(){v(!1)}),!0),s.a.createElement(m,{className:"emoji-button-div",ref:d.container},s.a.createElement(f,{icon:"smile",active:x,onClick:y}),x&&s.a.createElement(g,{ref:d.picker,onMouseEnter:function(){clearTimeout(o)},onMouseLeave:function(){o=setTimeout((function(){v(!1)}),1e3)},className:"chat-reaction-picker",orientation:w,onSelectEmoji:function(e){y(),l.react(n.id,e.id)},show:x}))}},641:function(e,n,t){"use strict";var i=t(11),a=t(9),r=t(1),s=t.n(r),o=t(10),l=t(19);function c(){var e=Object(a.a)(["\n  position: absolute;\n  bottom: 100%;\n  max-width: 250px;\n  left: ",";\n  right: ",";\n  z-index: 999;\n  ul {\n    max-height: 250px;\n\n    li {\n      display: flex;\n      text-align: left;\n\n      > span {\n        margin-left: 10px;\n      }\n    }\n  }\n"]);return c=function(){return e},e}function p(){var e=Object(a.a)(["\n    // position: absolute;\n    // right: ",";\n    // left: ",";\n    //top: 100%;\n    text-align: ",";\n    color: #a7abc3;\n    z-index: 2;\n    font-size: 11px;\n    position: absolute;\n    bottom: -18px;\n    white-space: nowrap;\n    ",";\n    span {\n        cursor: pointer;\n        &:hover {\n            color: #7A1B8B;\n            transition: color 0.3s;\n        }\n    }\n"]);return p=function(){return e},e}var u=o.a.div(p(),(function(e){return e.isAuthor?"0":"unset"}),(function(e){return e.isAuthor?"unset":"5px"}),(function(e){return e.isAuthor?"right":"left"}),(function(e){return e.isAuthor?"right: 0px":"left: 0px"})),d=Object(o.a)(l.u)(c(),(function(e){return e.isAuthor?"unset":"5px"}),(function(e){return e.isAuthor?"5px":"unset"}));n.a=function(e){var n=e.isPersonal,t=e.seenMembers,a=e.isAuthor,o=Object(r.useState)(!1),l=Object(i.a)(o,2),c=l[0],p=l[1],h=function(){return p(!c)};return s.a.createElement(u,e,n&&"seen",!n&&1===t.length&&"seen by ".concat(t.map((function(e){return e.first_name})).slice(0,1).toString()),!n&&t.length>1&&s.a.createElement(s.a.Fragment,null,"seen by"," ",t.map((function(e){return e.first_name})).slice(0,1).toString()," ","and",s.a.createElement("span",{onClick:h}," more")),!n&&t.length>1&&c&&s.a.createElement(d,{className:"chat-seen-list",users:t,isAuthor:a,onShowList:h}))}},647:function(e,n,t){"use strict";var i=t(11),a=t(9),r=t(1),s=t.n(r),o=t(10),l=t(25),c=t(139),p=t(19),u=t(196);function d(){var e=Object(a.a)(["\n  position: absolute;\n  bottom: 100%;\n  max-width: 250px;\n  left: ",";\n  right: ",";\n  visibility: hidden;\n  ul {\n    max-height: 250px;\n  }\n"]);return d=function(){return e},e}function h(){var e=Object(a.a)(["\n  background: ",";\n  color: ",";\n  padding: 4px;\n  display: flex;\n  align-items: center;\n  border-radius: 8px;\n  margin: 0 2px;\n  cursor: pointer;\n  position: relative;\n  :hover {\n    .chat-emoji-users-list {\n      visibility: visible;\n    }\n  }\n"]);return h=function(){return e},e}var m,f,g=o.a.div(h(),(function(e){return e.isAuthor?"rgb(157 57 173 / 93%)":"rgba(240, 240, 240, 0.8)"}),(function(e){return e.isAuthor?"#fff":"#505050"})),b=Object(o.a)(p.u)(d(),(function(e){return e.isAuthor?"unset":"5px"}),(function(e){return e.isAuthor?"5px":"unset"})),x=function(e){var n=e.type,t=e.count,i=e.reactions,a=e.isAuthor,r=e.reply,o=Object(u.a)();return s.a.createElement(g,{onClick:function(){o.react(r.id,n)},isAuthor:a,className:"chat-emoji"},s.a.createElement(c.a,{emoji:n,size:20}),t>1?s.a.createElement("span",{className:"emoji-counter"}," ",t):null,s.a.createElement(b,{className:"chat-emoji-users-list",isAuthor:a,users:i.map((function(e){return{id:e.user_id,name:e.user_name,profile_image_link:e.profile_image_link,profile_image_thumbnail_link:e.profile_image_thumbnail_link?e.profile_image_thumbnail_link:e.profile_image_link,partial_name:null}}))}))},v=t(12),y=o.a.div(m||(m=Object(a.a)(["\n  ul {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n    position: relative;\n    z-index: 100;\n  }\n  li {\n    position: relative;\n    padding: 3px;\n    border-bottom: 1px solid;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-between;\n    width: 100%;\n    :hover {\n      .chat-emoji-users-list {\n        visibility: visible;\n      }\n    }\n  }\n  li:last-child {\n    border: none;\n  }\n"]))),w=Object(o.a)(p.u)(f||(f=Object(a.a)(["\n  position: absolute;\n  bottom: 100%;\n  max-width: 250px;\n  left: ",";\n  right: ",";\n  top: 1px;\n  visibility: hidden;\n  ul {\n    max-height: 250px;\n    padding: 5px 10px;\n  }\n  .profile-slider {\n    display: none !important;\n  }\n"])),(function(e){return e.isAuthor?"unset":"116%"}),(function(e){return e.isAuthor?"116%":"unset"})),_=function(e){var n=e.className,t=e.reactions,i=e.handleShowMoreEmojis,a=e.isAuthor,o=e.reply,l=e.chatReactionAction,p=Object(r.useRef)();Object(v.F)(p,i,!0);return s.a.createElement(y,{className:n,ref:p},s.a.createElement("ul",null,t.map((function(e){return s.a.createElement("li",{key:e.type,onClick:function(){return function(e){var n={message_id:o.id,react_type:e};l(n)}(e.type)}},s.a.createElement(c.a,{emoji:e.type,size:16}),s.a.createElement("span",null,e.reactions.length),s.a.createElement(w,{className:"chat-emoji-users-list",isAuthor:a,users:e.reactions.map((function(e){return{id:e.user_id,name:e.user_name,profile_image_link:e.profile_image_link,profile_image_thumbnail_link:e.profile_image_thumbnail_link?e.profile_image_thumbnail_link:e.profile_image_link,partial_name:null}}))}))}))))};function C(){var e=Object(a.a)(["\n  position: absolute;\n  background: #dedede;\n  border-radius: 8px;\n  max-width: 100px;\n  min-width: 60px;\n  padding: 5px;\n  top: 100%;\n  right: ",";\n  left: ",";\n  margin-top: 5px;\n  //visibility: hidden;\n"]);return C=function(){return e},e}function A(){var e=Object(a.a)(["\n  background: #dedede;\n  padding: 2px 5px;\n  display: flex;\n  align-items: center;\n  border-radius: 8px;\n  margin: 0 2px;\n  position: relative;\n  cursor: pointer;\n  // :hover {\n  //     .chat-reactions-list {\n  //         visibility: visible;\n  //     }\n  // }\n"]);return A=function(){return e},e}function j(){var e=Object(a.a)(["\n  // position: absolute;\n  //bottom: -20px;\n  margin-top: -8px;\n  display: inline-flex;\n  max-width: 90%;\n  z-index: 1;\n  flex-flow: ",";\n  align-self: ",";\n  .profile-slider {\n    left: 60px !important;\n    right: unset !important;\n    bottom: 0px !important;\n    top: unset !important;\n  }\n  .chat-right & {\n    .profile-slider {\n      left: unset !important;\n      right: 0 !important;\n      bottom: 100% !important;\n      top: unset !important;\n    }\n  }\n"]);return j=function(){return e},e}var E=o.a.div(j(),(function(e){return e.isAuthor?"row-reverse":"row"}),(function(e){return e.isAuthor?"flex-end":"flex-start"})),O=o.a.div(A()),k=Object(o.a)(_)(C(),(function(e){return e.isAuthor?"0":"unset"}),(function(e){return e.isAuthor?"unset":"0"}));n.a=function(e){var n=e.reactions,t=e.isAuthor,a=e.chatReactionAction,o=e.reply,c=function(e){var n=Object(r.useRef)();return Object(r.useEffect)((function(){n.current=e})),n.current}(n.length),p=Object(r.useState)(!1),u=Object(i.a)(p,2),d=u[0],h=u[1],m=function(){return h(!d)},f=function(){return Object.entries(Object(l.b)(n,"react_type")).map((function(e){return{type:e[0],reactions:e[1]}}))},g=Object(r.useState)(f()),b=Object(i.a)(g,2),v=b[0],y=b[1];return Object(r.useEffect)((function(){y(f())}),[]),Object(r.useEffect)((function(){c!==n.length&&y(Object.entries(Object(l.b)(n,"react_type")).map((function(e){return{type:e[0],reactions:e[1]}})))}),[n,c]),s.a.createElement(E,{isAuthor:t},v.slice(0,7).map((function(e){return s.a.createElement(x,{userReacted:!1,key:e.type,type:e.type,count:e.reactions.length,reactions:e.reactions,isAuthor:t,chatReactionAction:a,reply:o})})),v.length>7&&s.a.createElement(O,null,s.a.createElement("span",{onClick:m},"..."),d&&s.a.createElement(k,{isAuthor:t,reactions:v.slice(7),className:"chat-reactions-list",handleShowMoreEmojis:m,chatReactionAction:a,reply:o})))}},732:function(e,n,t){"use strict";t.r(n);var i,a,r,s,o,l,c,p,u,d,h,m,f,g,b=t(0),x=t(117),v=t(118),y=t(205),w=t(202),_=t(9),C=t(1),A=t.n(C),j=t(626),E=t(5),O=t(36),k=t(10),M=t(19),R=t(638),N=t(639),S=t(640),L=t(647),T=t(641),I=t(17),F=t(123),B=Object(C.lazy)((function(){return t.e(14).then(t.bind(null,722))})),z=Object(C.lazy)((function(){return t.e(23).then(t.bind(null,723))})),D=k.a.div(i||(i=Object(_.a)(["\n  background: transparent;\n  background-repeat: repeat;\n  height: calc(100% - 125px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  -webkit-overflow-scrolling: touch;\n  //z-index: 1;\n  scrollbar-width: none;\n  > ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n  .chat-message-options svg {\n    fill: currentColor;\n  }\n  &.is-processed {\n    opacity: 0;\n  }\n"]))),P=k.a.li(a||(a=Object(_.a)(["\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  margin-bottom: ",";\n  text-align: center;\n  .chat-actions-container {\n    opacity: 0;\n  }\n\n  &:hover {\n    .chat-actions-container {\n      opacity: 1;\n    }\n  }\n  &.pulsating div.chat-bubble {\n    animation: blinker 2s linear forwards;\n    @keyframes blinker {\n      50% {\n        opacity: 0.5;\n      }\n    }\n  }\n"])),(function(e){return e.isLastChat?"20px":"5px"})),U=k.a.div(r||(r=Object(_.a)(["\n  z-index: 2;\n  color: #a7abc3;\n  display: inline-block;\n  left: 50%;\n  position: sticky;\n  top: 10px;\n  transform: translateX(-50%);\n  span {\n    padding: 4px 8px;\n    display: inline-block;\n    font-size: 11px;\n    border-radius: 6px;\n    margin: 0 4px;\n    background: #f0f0f0;\n  }\n  &[stuck] {\n    &:before,\n    &:after {\n      display: none;\n    }\n  }\n"]))),H=k.a.div(s||(s=Object(_.a)(["\n  display: flex;\n  width: 100%;\n  align-items: center;\n  justify-content: flex-end;\n  flex-flow: column;\n  flex-flow: ",";\n  margin-left: ",";\n  ",";\n  margin-top: ",";\n  margin-top: ",";\n  @media (max-width: 620px) {\n    margin-top: ",";\n    margin-top: ",";\n    ",";\n    ",";\n    ",";\n  }\n  &:before {\n    ",";\n    border: 10px solid transparent;\n    border-right-color: ",";\n    position: absolute;\n    top: ",";\n    left: 30px;\n    z-index: 1;\n    @media all and (max-width: 620px) {\n      display: none;\n    }\n    ",";\n  }\n  .dark & {\n    &:before {\n      ",";\n      border: 10px solid transparent;\n      position: absolute;\n      top: ",";\n      left: 30px;\n      z-index: 1;\n      @media all and (max-width: 620px) {\n        display: none;\n      }\n      ",";\n    }\n  }\n"])),(function(e){return e.isAuthor?"row":"row-reverse"}),(function(e){return e.isAuthor||e.showAvatar?"0":"22px"}),(function(e){return!0===e.isAuthor&&"position: relative; right: 15px;"}),(function(e){return e.showAvatar&&"36px"}),(function(e){return e.showAvatar&&e.isAuthor&&"20px"}),(function(e){return e.showAvatar&&"12px"}),(function(e){return e.showAvatar&&e.isAuthor&&"8px"}),(function(e){return!e.showAvatar&&!e.isAuthor&&!e.isBot&&"margin-left: 0"}),(function(e){return!0===e.isAuthor&&!e.showAvatar&&"position: relative; right: 0px;"}),(function(e){return!0===e.isAuthor&&"position: relative; right: 0px;"}),(function(e){return e.showAvatar&&"content: '';"}),(function(e){return e.isImportant?"#7B68EE":e.isExternalChat?"#FFDB92":"#f0f0f0"}),(function(e){return e.showAvatar&&!e.isAuthor?"42px":"6px"}),(function(e){return!0===e.isAuthor&&"\n            left: auto;\n            right: -16px;\n            border-left-color:  ".concat((function(e){return e.isImportant?"#7B68EE":"#7A1B8B"}),";\n            border-right-color: transparent;\n            @media all and (max-width: 620px) {\n              display: none;\n            }\n        ")}),(function(e){return e.showAvatar&&"content: '';"}),(function(e){return e.showAvatar&&!e.isAuthor?"42px":"6px"}),(function(e){return!0===e.isAuthor&&"\n            left: auto;\n            right: -16px;            \n            border-right-color: transparent;\n            @media all and (max-width: 620px) {\n              display: none;\n            }\n        "})),V=k.a.div(o||(o=Object(_.a)(["\n  flex-flow: ",";\n  flex-wrap: wrap;\n  ",";\n  min-width: 150px;\n  color: #a7abc3;\n  background: #ffffff;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  top: 0;\n  ",";\n  height: calc(100% + 4px);\n  margin-top: -2px;\n  transition: opacity 0.3s ease;\n"])),(function(e){return e.isAuthor?"row-reverse":"row"}),(function(e){return e.isAuthor?"margin-right: 10px":"margin-left: 10px"}),(function(e){return e.isAuthor?"right: 100%":"left: 100%"})),Y=k.a.div(l||(l=Object(_.a)(["\n  flex-flow: ",";\n  flex-wrap: wrap;\n  ",";\n  min-width: 150px;\n  color: #a7abc3;\n  background: #ffffff;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  top: 0;\n  ",";\n  height: calc(100% + 4px);\n  margin-top: -2px;\n  transition: opacity 0.3s ease;\n  button {\n    margin: 5px;\n  }\n"])),(function(e){return e.isAuthor?"row-reverse":"row"}),(function(e){return e.isAuthor?"margin-right: 10px":"margin-left: 10px"}),(function(e){return e.isAuthor?"right: 100%":"left: 100%"})),Q=Object(k.a)(R.a)(c||(c=Object(_.a)(["\n  display: flex;\n  flex-direction: column;\n  flex-basis: 100%;\n  flex: 1;\n  margin: 5px;\n  max-width: 25px;\n\n  @media (max-width: 620px) {\n    margin-right: 0;\n  }\n\n  .more-options-tooltip {\n    &.orientation-bottom {\n      top: calc(100% - 35px);\n      @media (max-width: 620px) {\n        top: 100%;\n      }\n    }\n\n    &.orientation-top {\n      @media (max-width: 620px) {\n        bottom: 30px;\n      }\n    }\n\n    &.orientation-right {\n      left: calc(100% + 10px);\n      @media (max-width: 620px) {\n        left: 0;\n      }\n    }\n    &.orientation-left {\n      @media (max-width: 620px) {\n        left: auto;\n        right: 0;\n      }\n    }\n  }\n"]))),q=k.a.div(p||(p=Object(_.a)(["\n  //width: 100%;\n  //overflow: hidden;\n  max-width: 75%;\n  position: relative;\n  flex-flow: column;\n  display: inherit;\n  margin-left: ",";\n  > img {\n    max-height: 300px;\n    max-width: 100%;\n    width: auto;\n    object-fit: cover;\n  }\n  .edited-message {\n    color: #aab0c8;\n    font-style: italic;\n    display: flex;\n    align-items: center;\n    font-size: 12px;\n    position: absolute;\n    top: 50%;\n    margin: 0 10px;\n    height: 25px;\n    white-space: nowrap;\n    ",";\n  }\n  .chat-options {\n    visibility: hidden;\n  }\n  .chat-options.active {\n    visibility: visible;\n  }\n  :hover {\n    .chat-options {\n      visibility: visible;\n    }\n  }\n  @media (max-width: 991.99px) {\n    max-width: calc(100% - 110px);\n  }\n\n  @media (max-width: 620px) {\n    ",";\n    ",";\n  }\n"])),(function(e){return e.showAvatar&&!e.isAuthor?"1rem":"1.6rem"}),(function(e){return e.isAuthor?"right: 100%;":"left: 100%"}),(function(e){return!e.showAvatar&&!e.isAuthor&&"margin-left: 0"}),(function(e){return!0===!e.isAuthor&&"margin-left: 0"})),W=k.a.div(u||(u=Object(_.a)(["\n  position: relative;\n  display: inline-flex;\n  border-radius: 8px;\n  background: #f4f4f4f4;\n  text-align: left;\n  min-width: 100px;\n  max-width: 100%;\n  padding: 7px 15px;\n  line-height: 1.5rem;\n  float: left;\n  align-items: center;\n  justify-content: flex-end;\n  flex-flow: ",";\n  .chat-options {\n    visibility: hidden;\n  }\n  :hover {\n    .chat-options {\n      visibility: visible;\n    }\n  }\n  @media (max-width: 620px) {\n    padding: 7px;\n  }\n"])),(function(e){return e.isAuthor?"row":"row-reverse"})),G=k.a.span(d||(d=Object(_.a)(["\n  color: red;\n  margin: 0 10px;\n"]))),J=k.a.div(h||(h=Object(_.a)(["\n  display: flex;\n  justify-content: center;\n  &.initial-load {\n    position: absolute;\n    top: 45%;\n    left: 45%;\n    transform: translate(-45%, -45%);\n  }\n"]))),K=k.a.div(m||(m=Object(_.a)(["\n  width: 100%;\n  ul {\n    margin: 0;\n  }\n"]))),X=Object(k.a)(M.a)(f||(f=Object(_.a)(["\n  align-self: flex-start;\n  width: 2rem !important;\n  height: 2rem !important;\n  margin-top: ",";\n\n  img {\n    width: 2rem !important;\n    height: 2rem !important;\n  }\n  @media (max-width: 620px) {\n    display: none;\n  }\n  .pixel-avatar {\n    padding-top: 2px !important;\n  }\n"])),(function(e){return!0===e.isForwardedMessage?"25px":"0"})),Z=k.a.div(g||(g=Object(_.a)(["\n  display: flex;\n  -webkit-box-align: center;\n  align-items: center;\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  svg {\n    max-width: 100%;\n    width: 100%;\n    max-height: 40%;\n    margin: auto;\n  }\n"]))),$=function(e){Object(y.a)(t,e);var n=Object(w.a)(t);function t(e){var i;return Object(x.a)(this,t),(i=n.call(this,e)).loadReplies=function(){var e=i.props,n=e.selectedChannel,t=e.chatMessageActions,a=i.props.scrollComponent.current;if(!n.isFetching&&n.hasMore){t.channelActions.fetchingMessages(n,!0);var r={skip:0,limit:20};"undefined"!==typeof n.replies&&(r={skip:0===n.skip&&n.replies.length?n.replies.length:n.skip,limit:20}),t.fetch(n,r,(function(e,r){if(e)t.channelActions.fetchingMessages(n,!1);else if((0===n.replies.length||0===n.skip)&&"object"!==typeof i.props.history.location.state){a.scrollTop=a.scrollHeight;var s=a.scrollHeight;setTimeout((function(){s<a.scrollHeight&&(a.scrollTop=a.scrollHeight)}),1e3)}}))}},i.handleReadChannel=function(){if(i.props.unreadCount>0||i.props.selectedChannel.total_unread>0){var e=i.props,n=e.selectedChannel;e.chatMessageActions.channelActions.markAsRead(n)}},i.handleResendMessage=function(e){i.props.createChatMessageV2Action(e,(function(n,t){n&&i.props.onFailedMessageSend(e)}))},i.handleRemoveReply=function(e){i.props.cbOnRemoveReply(e)},i.handleEditReply=function(e){i.props.onEditReply(e)},i.handleQuoteReply=function(e){i.props.onSelectQuote(e)},i.handleLoadMoreRefChange=function(e,n){e&&i.loadReplies()},i.handleShowSeenUsers=function(){return i.setState({showSeenUsers:!i.state.showSeenUsers})},i.filterSeenMembers=function(){return i.props.selectedChannel.members.filter((function(e){return 2===i.props.selectedChannel.members.length?!(!i.props.selectedChannel.last_reply||!i.props.selectedChannel.last_reply.user)&&(i.props.selectedChannel.last_reply.user.id===i.props.user.id?!(i.props.user.id===e.id):!(i.props.selectedChannel.last_reply.user.id===e.id)):(!i.props.selectedChannel.last_reply||!i.props.selectedChannel.last_reply.user||i.props.selectedChannel.last_reply.user.id!==e.id)&&i.props.user.id!==e.id})).filter((function(e){return!!e.last_visited_at&&e.last_visited_at.timestamp>=i.props.selectedChannel.last_reply.created_at.timestamp}))},i.getLoadRef=function(e){var n=i.props.selectedChannel,t=!1;if(n.replies.length&&!n.isFetching){var a=n.replies.findIndex((function(n){return n.id===e}));a<Math.round(n.replies.length/2)&&a%2===0&&(t=!0)}return t},i.gMessages=Object(F.a)((function(e){return Object.entries(e.sort((function(e,n){return e.created_at.timestamp-n.created_at.timestamp===0?e.id-n.id:e.created_at.timestamp-n.created_at.timestamp})).map((function(e,n){return e.hasOwnProperty("g_date")?Object(b.a)(Object(b.a)({},e),{},{isLastChat:n===i.props.selectedChannel.replies.length-1}):Object(b.a)(Object(b.a)({},e),{},{g_date:i.props.timeFormat.localizeDate(e.created_at.timestamp,"YYYY-MM-DD"),isLastChat:n===i.props.selectedChannel.replies.length-1})})).reduce((function(e,n){var t=n.g_date;return e[t]=e[t]||[],e[t].push(n),e}),{}))})),i.state={hasArrowUpListener:!1,loadMoreInView:!1,fetchingReplies:!1,showEmoji:{}},i.infiniteScroll=A.a.createRef(),i.mouseOver=A.a.createRef(!1),i}return Object(v.a)(t,[{key:"componentWillUnmount",value:function(){var e=this.props.scrollComponent.current;this.props.chatMessageActions.channelActions.saveHistoricalPosition(this.props.selectedChannel.id,e)}},{key:"componentDidMount",value:function(){var e=this.props,n=e.selectedChannel,t=e.historicalPositions,i=this.props.scrollComponent.current;"object"!==typeof this.props.history.location.state&&(t.length?t.forEach((function(e){e.channel_id===n.id&&i&&(i.scrollTop=i.scrollHeight-e.scrollPosition)})):i&&(i.scrollTop=i.scrollHeight)),n.hasMore&&0===n.skip&&this.loadReplies(),n.is_read&&this.handleReadChannel()}},{key:"getSnapshotBeforeUpdate",value:function(e,n){var t=this.props.selectedChannel,i=this.props.scrollComponent.current;return e.selectedChannel&&e.selectedChannel&&e.selectedChannel.replies&&t.replies&&i&&t.replies.length>20&e.selectedChannel.replies.length<t.replies.length&&t.replies.length-e.selectedChannel.replies.length>=2?i.scrollHeight-i.scrollTop:null}},{key:"componentDidUpdate",value:function(e,n,t){var i=this.props,a=i.selectedChannel,r=i.historicalPositions,s=this.props.scrollComponent.current;this.props.selectedChannel&&e.selectedChannel.id!==a.id&&(a.hasMore&&0===a.skip&&this.loadReplies(),this.handleReadChannel(),r.length&&r.forEach((function(e){e.channel_id===a.id&&s&&(s.scrollTop=s.scrollHeight-e.scrollPosition)}))),a&&e.selectedChannel.id===this.props.selectedChannel.id&&(null!==t&&a.replies.length!==e.selectedChannel.replies.length&&(a.replies.length-e.selectedChannel.replies.length===1?a.last_reply&&a.last_reply.user&&a.last_reply.user.id!==this.props.user.id&&(this.props.isLastChatVisible||(s.scrollTop=s.scrollHeight-t)):s.scrollTop=s.scrollHeight-t),a.replies&&a.replies.length&&a.replies.length-e.selectedChannel.replies.length===1&&(a.last_reply&&a.last_reply.user&&a.last_reply.user.id===this.props.user.id?s&&(s.scrollTop=s.scrollHeight):this.props.isLastChatVisible&&!this.props.isIdle&&this.props.isBrowserActive&&document.hasFocus()&&(a.is_read&&this.props.chatMessageActions.channelActions.markAsRead(a),s&&(s.scrollTop=s.scrollHeight)))),this.props.unreadCount>0&&this.props.isLastChatVisible&&!this.props.isIdle&&this.props.isBrowserActive&&document.hasFocus()&&this.handleReadChannel()}},{key:"render",value:function(){var e=this,n=0,t=this.gMessages(this.props.selectedChannel.replies);return A.a.createElement(D,{ref:this.props.scrollComponent,id:"component-chat-thread",className:"component-chat-thread messages ".concat(this.props.className),tabIndex:"2"},this.props.selectedChannel.isFetching&&this.props.selectedChannel.hasMore&&0===this.props.selectedChannel.replies.length&&0===this.props.selectedChannel.skip&&A.a.createElement(J,{className:"initial-load"},A.a.createElement(M.j,null)),A.a.createElement(K,{ref:this.infiniteScroll,className:"infinite-scroll",id:"infinite-scroll-chat-replies"},this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length>=20&&A.a.createElement(j.a,{as:"div",onChange:function(n,t){return e.handleLoadMoreRefChange(n,t)}},A.a.createElement("span",{className:"intersection-load-more-ref"})),A.a.createElement("ul",null,this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length?t.map((function(t,i){return A.a.createElement("div",{key:"".concat(t[0])},A.a.createElement(U,{className:"timestamp-container"},A.a.createElement("span",null,e.props.timeFormat.localizeChatDate(t[1][0].created_at.timestamp,"ddd, MMM DD, YYYY"))),t[1].map((function(t,i,a){var r=t.user&&t.user.id===e.props.user.id,s=!1,o=!1,l=!1,c=!1,p=!1;if(t.user){t.created_at.timestamp&&(0===i&&(o=!0,s=!0),0!==i&&e.props.timeFormat.localizeDate(a[i-1].created_at.timestamp,"D")!==e.props.timeFormat.localizeDate(t.created_at.timestamp,"D")&&(o=!0,s=!0),0!==i&&t.created_at.timestamp-a[i-1].created_at.timestamp>600&&(s=!0)),0!==i&&!0===a[i-1].is_read&&!1===t.is_read&&(p=!0),0!==i&&null===a[i-1].user&&(s=!0),n!==t.user.id&&(s=!0,n=t.user.id),"undefined"!==typeof t.body&&null!==t.body&&null!==t.body.match(I.b)&&(l=!0);c=["gripp_bot_account","gripp_bot_invoice","gripp_bot_offerte","gripp_bot_project","gripp_bot_account","driff_webhook_bot","huddle_bot"].includes(t.user.code)}return A.a.createElement(P,{key:t.id,className:"chat-list chat-list-item-".concat(t.id," code-").concat(t.code," "),showTimestamp:o,isLastChat:t.isLastChat},t.user&&p&&e.props.unreadCount>0&&A.a.createElement(N.a,null),t.user&&A.a.createElement(H,{isAuthor:r,className:"chat-reply-list-item chat-reply-list-item-".concat(t.id," ").concat(r?"chat-right":"chat-left"),showAvatar:s,isBot:c,isImportant:t.is_important,isExternalChat:t.user&&e.props.users[t.user.id]&&"external"===e.props.users[t.user.id].type&&!r},t.message_failed?A.a.createElement(G,null,A.a.createElement("i",{className:"fas fa-times-circle",onClick:function(n){return e.handleResendMessage(t.payload)}})):null,A.a.createElement(q,{isAuthor:r,showAvatar:s,className:"chat-bubble-quote-div"},A.a.createElement(C.Suspense,{fallback:A.a.createElement("div",null)},A.a.createElement(B,{chatMessageActions:e.props.chatMessageActions,timeFormat:e.props.timeFormat,user:e.props.user,reply:t,showAvatar:s,selectedChannel:e.props.selectedChannel,showGifPlayer:l,isAuthor:r,addMessageRef:e.getLoadRef(t.id),isLastChat:t.isLastChat,loadReplies:e.loadReplies,chatSettings:e.props.settings,isLastChatVisible:e.props.isLastChatVisible,dictionary:e.props.dictionary,users:e.props.users,translate:e.props.translate,language:e.props.language,translated_channels:e.props.translated_channels,chat_language:e.props.chat_language},A.a.createElement(V,{isAuthor:r,className:"chat-actions-container"},A.a.createElement(S.a,{isAuthor:r,reply:t,showEmojiSwitcher:e.state.showEmoji[t.id]}),!isNaN(t.id)&&!t.is_deleted&&A.a.createElement(Q,{dictionary:e.props.dictionary,className:"chat-message-options",selectedChannel:e.props.selectedChannel,isAuthor:r,replyData:t,teamChannelId:e.props.teamChannelId,isExternalUser:"external"===e.props.user.type})))),t.reactions.length>0&&A.a.createElement(L.a,{reactions:t.reactions,isAuthor:r,reply:t,loggedUser:e.props.user,chatReactionAction:e.props.chatReactionV2Action}),e.props.selectedChannel.last_reply&&e.props.selectedChannel.last_reply.id===t.id&&e.filterSeenMembers().length>0&&A.a.createElement(T.a,{isAuthor:r,onClick:e.handleShowSeenUsers,seenMembers:e.filterSeenMembers(),isPersonal:2===e.props.selectedChannel.members.length})),!r&&s&&A.a.createElement(X,{isForwardedMessage:t.is_transferred,id:t.user.id,type:"USER",imageLink:t.user.profile_image_thumbnail_link?t.user.profile_image_thumbnail_link:t.user.profile_image_link,name:t.user.name,isBot:c,isHuddleBot:"huddle_bot"===t.user.code,showSlider:!0})),null===t.user&&A.a.createElement(H,{className:"chat-reply-list-item system-reply-list-item chat-reply-list-item-".concat(t.id),isAuthor:!1},A.a.createElement(q,{isAuthor:r,showAvatar:s,className:"chat-bubble-quote-div"},A.a.createElement(W,{className:"system-message",isAuthor:!1},A.a.createElement(C.Suspense,{fallback:A.a.createElement("div",null)},A.a.createElement(z,{user:e.props.user,chatMessageActions:e.props.chatMessageActions,timeFormat:e.props.timeFormat,selectedChannel:e.props.selectedChannel,reply:t,addMessageRef:e.getLoadRef(t.id),isLastChat:t.isLastChat,isLastChatVisible:e.props.isLastChatVisible,dictionary:e.props.dictionary,users:e.props.users})),A.a.createElement(Y,{isAuthor:r,className:"chat-actions-container"},A.a.createElement(S.a,{isAuthor:r,reply:t,showEmojiSwitcher:e.state.showEmoji[t.id]}),!isNaN(t.id)&&!t.is_deleted&&A.a.createElement(Q,{dictionary:e.props.dictionary,scrollRef:e.props.scrollComponent,replyData:t,className:"chat-message-options",selectedChannel:e.props.selectedChannel,isAuthor:r,teamChannelId:e.props.teamChannelId,isExternalUser:"external"===e.props.user.type}))),t.reactions.length>0&&A.a.createElement(L.a,{reactions:t.reactions,reply:t,isAuthor:!1,loggedUser:e.props.user,chatReactionAction:e.props.chatReactionV2Action}))))})))})):null,!this.props.selectedChannel.isFetching&&this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length<1&&A.a.createElement(Z,{className:"no-reply-container"},A.a.createElement(M.q,{icon:3})))))}}]),t}(A.a.PureComponent);n.default=Object(O.k)(Object(E.b)((function(e){var n=e.global,t=n.isIdle,i=n.isBrowserActive,a=e.session.user,r=e.chat,s=r.historicalPositions,o=r.isLastChatVisible,l=r.selectedChannel,c=e.users.users;return{user:a,settings:e.settings.user.CHAT_SETTINGS,historicalPositions:s,isLastChatVisible:o,users:c,isIdle:t,isBrowserActive:i,selectedChannel:l}}),null)($))}}]);