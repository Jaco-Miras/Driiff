(this.webpackJsonpdriff=this.webpackJsonpdriff||[]).push([[21],{1001:function(e,n,t){"use strict";t.r(n);var r=t(9),a=t(1),i=t(119),o=t(149),s=t(188),l=t(187),c=t(6),p=t(0),u=t.n(p),d=t(886),h=t(4),m=t(49),f=t(5),g=t(12),b=t(7),x=(t(428),t(10)),y=t(918),v=t(919),w=t(920),E=t(35),A=t.n(E);function _(){var e=Object(c.a)(["\n  padding: ",";\n  font-weight: 500;\n  color: #929496;\n  &.important {\n    font-weight: 600;\n    color: #191c20;\n  }\n  @media (max-width: 620px) {\n    display: block;\n    font-size: 11px;\n    line-height: 1.2;\n  }\n"]);return _=function(){return e},e}function O(){var e=Object(c.a)(["\n  color: #aab0c8;\n  font-style: italic;\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n  position: absolute;\n  top: calc(50% - 25px);\n  margin: 0 10px;\n  ",";\n  height: 25px;\n  white-space: nowrap;\n\n  svg {\n    width: 15px;\n    height: 15px;\n    position: relative;\n    top: 2px;\n    margin-right: 5px;\n  }\n"]);return O=function(){return e},e}function C(){var e=Object(c.a)(["\n  display: flex;\n  margin-right: 2rem;\n  flex-flow: ",";\n  width: 100%;\n  align-items: ",";\n  justify-content: ",";\n  .reply-date {\n    margin: ",";\n    flex-flow: column;\n    justify-content: center;\n    color: #a7abc3;\n    font-size: 11px;\n  }\n  .reply-date.updated {\n    > span:last-child {\n      display: none;\n    }\n  }\n  .reply-date.updated:hover {\n    > span:first-child {\n      display: none;\n    }\n    > span:last-child {\n      display: block;\n    }\n  }\n  .msg-fail {\n    color: red;\n  }\n  @media (min-width: 768px) {\n    display: ",";\n    .reply-date {\n      color: ",";\n      margin-left: 0;\n    }\n  }\n"]);return C=function(){return e},e}function j(){var e=Object(c.a)(["\n  ","\n\n  .reply-author {\n    ",";\n  }\n  .reply-content {\n    clear: both;\n    width: 100%;\n    display: block;\n    z-index: 1;\n\n    p {\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: pre-wrap;\n      word-wrap: break-word;\n\n      a {\n        color: ",";\n        overflow: hidden;\n        white-space: nowrap;\n        text-overflow: ellipsis;\n\n        @media only screen and (max-width: 1024px) {\n          white-space: normal;\n          word-break: break-word;\n\n          &:hover {\n            word-break: unset;\n          }\n        }\n\n        &:hover {\n          overflow: unset;\n          white-space: unset;\n          text-overflow: unset;\n          word-break: break-word;\n        }\n      }\n    }\n  }\n  .gif_player {\n    clear: both;\n    position: relative;\n    left: 0;\n    overflow: hidden;\n    //height: 250px;\n    min-height: 150px;\n    cursor: pointer;\n    .gifPlayer {\n      border-radius: 8px;\n      max-height: 250px;\n    }\n    .play_button {\n      height: 60px;\n      width: 60px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n  }\n"]);return j=function(){return e},e}function k(){var e=Object(c.a)(["\n  display: flex;\n  flex-flow: ",";\n\n  .chat-content {\n    width: 100%;\n    padding-left: 0;\n  }\n\n  .chat-clap {\n    float: ",";\n  }\n"]);return k=function(){return e},e}function M(){var e=Object(c.a)(["\n  max-width: ",";\n  padding: ",";\n  // // max-width: ",";\n  // padding: ",";\n  ul {\n    list-style-type: none;\n  }\n\n  a {\n    cursor: pointer;\n    color: ",";\n    text-decoration: underline;\n\n    &:focus,\n    &:hover {\n      color: ",";\n    }\n    &.btn {\n      border: 1px solid ",";\n\n      &:focus,\n      &:hover {\n        border: 1px solid ",";\n      }\n\n      &.btn-action {\n        margin-top: 0.5rem;\n        border-radius: 8px;\n      }\n\n      &.btn-complete {\n        color: ",";\n        border: 1px solid ",";\n      }\n    }\n  }\n\n  span.completed {\n    text-decoration: line-through;\n  }\n"]);return M=function(){return e},e}function N(){var e=Object(c.a)(["\n  color: ",";\n  max-width: 100%;\n  img,\n  video {\n    display: none;\n  }\n  .video-quote,\n  .image-quote {\n    img {\n      width: auto;\n      display: inline-block;\n    }\n  }\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: pre-wrap;\n  a {\n    color: ",";\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n\n    @media only screen and (max-width: 1024px) {\n      white-space: normal;\n      word-break: break-word;\n\n      &:hover {\n        word-break: unset;\n      }\n    }\n\n    &:hover {\n      overflow: unset;\n      white-space: unset;\n      text-overflow: unset;\n      word-break: break-word;\n    }\n  }\n"]);return N=function(){return e},e}function R(){var e=Object(c.a)(["\n  font-weight: 600;\n  @media all and (max-width: 620px) {\n    font-size: 11px;\n    line-height: 1.2;\n    font-weight: normal;\n  }\n"]);return R=function(){return e},e}function F(){var e=Object(c.a)(["\n  background: ",";\n  border-radius: 6px;\n  margin: 4px -4px 4px -4px;\n  text-align: left;\n  padding: 10px 10px 10px 20px;\n  position: relative;\n  cursor: pointer;\n  max-width: ",";\n  &:before {\n    height: 70%;\n    width: 5px;\n    background: ",";\n    background: #ffffffe6;\n    position: absolute;\n    ",";\n    display: inline-block;\n    float: left;\n    left: 5px;\n    opacity: 0.8;\n    @media all and (max-width: 620px) {\n      display: none;\n    }\n  }\n  @media all and (max-width: 620px) {\n    margin: 7px -7px 10px -7px;\n    padding: 7px;\n  }\n"]);return F=function(){return e},e}function T(){var e=Object(c.a)(["\n  position: relative;\n  display: inline-flex;\n  flex-flow: column;\n  padding: ",";\n  border-radius: 6px;\n  background: ",";\n  text-align: left;\n  width: fit-content;\n  color: ",";\n  font-size: 0.835rem;\n  overflow: visible;\n  min-height: ",";\n  &:after {\n    border: 10px solid #0000;\n    position: absolute;\n    top: 6px;\n    z-index: 1;\n    ",";\n    border-left-color: ",";\n    border-right-color: ",";\n    height: 5px;\n  }\n\n  // a:not([href]):not([tabindex]) {\n  //   color: ",";\n\n  //   &:hover {\n  //     color: ",";\n  //   }\n  // }\n\n  video {\n    width: 100%;\n  }\n  p.reply-author {\n    color: ",";\n    font-weight: 400;\n    font-size: 12px;\n    font-style: italic;\n    margin: 0;\n    display: block;\n    position: absolute;\n    top: -24px;\n    left: 0;\n    white-space: nowrap;\n    ","\n  }\n  span.emoticon-body {\n    font-size: 2.5rem;\n    padding: 20px 10px;\n    text-align: ",";\n  }\n  .reply-content img {\n    max-width: 100%;\n    max-height: 300px;\n  }\n  span.reply-date {\n    color: ",";\n    font-style: italic;\n    font-size: 11px;\n    position: absolute;\n    top: 0;\n    ",";\n    display: flex;\n    height: 100%;\n    text-align: ",";\n    white-space: nowrap;\n    position: absolute;\n  }\n  ol {\n    text-align: left;\n    position: relative;\n    padding-inline-start: 0;\n    li {\n      margin-left: 0;\n    }\n  }\n  ul {\n    li {\n      text-align: left;\n      position: relative;\n      margin-left: 0;\n    }\n  }\n  span.is-deleted {\n    font-style: italic;\n    color: ",";\n  }\n  span.image-uploading {\n    display: none;\n  }\n  .chat-file-notification {\n    b:hover {\n      text-decoration: underline;\n      cursor: pointer;\n    }\n  }\n  a.a_fancy {\n    border-radius: 5px !important;\n    background-color: #fff !important;\n    box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.11) !important;\n    text-decoration: none !important;\n    display: inline-block;\n    height: auto !important;\n    padding: 5px 10px;\n    margin-bottom: 5px;\n    color: #000 !important;\n    font-family: Inter !important;\n    font-size: 13px !important;\n    letter-spacing: 0 !important;\n    line-height: 21px !important;\n    margin-right: 1pt;\n    margin-left: 1pt;\n  }\n  .message-files div:first-child {\n    align-items: ",";\n  }\n  &.external-chat {\n    background-color: ","!important;\n    color: #000 !important;\n    .chat-name-not-author-mobile {\n      color: #000 !important;\n    }\n  }\n  @media (min-width: 768px) {\n    width: 100%;\n  }\n"]);return T=function(){return e},e}var S=f.b.div(T(),(function(e){return e.hasFiles?"3px":"6px 9px 8px 9px"}),(function(e){return e.isAuthor?e.theme.colors.primary:"#F0F0F0"}),(function(e){return e.isAuthor?"#ffffff":"#000000"}),(function(e){return e.hasGif?"150px":"33px"}),(function(e){return e.isAuthor?"right: -16px":"left: -15px"}),(function(e){return e.isAuthor?"#7A1B8B":"#0000"}),(function(e){return e.isAuthor?"#0000":"#F0F0F0"}),(function(e){return e.isAuthor?"#ffffff":"#8C3B9B"}),(function(e){return e.isAuthor?"#fff":"#0056b3"}),(function(e){return e.isAuthor?"#ffffff":"#AAB0C8"}),(function(e){return!0===e.isForwardedMessage&&"top: -40px;"}),(function(e){return e.isAuthor?"right":"left"}),(function(e){return e.showAvatar&&!1===e.hideBg||e.hasRemoveOnDlFiles||e.showAvatar&&e.hasFiles?"#a7abc3":"#0000"}),(function(e){return e.isAuthor?"right: 100%":"left: 100%"}),(function(e){return e.isAuthor?"right":"left"}),(function(e){return e.isAuthor?"#ffffffe6":"#AAB0C8"}),(function(e){return e.isAuthor?"flex-end":"flex-start"}),(function(e){return e.theme.colors.fourth})),I=f.b.div(F(),(function(e){return e.isAuthor?"#8C3B9B":"#E4E4E4"}),(function(e){return e.hasFiles?"210px":"auto"}),(function(e){return e.isAuthor?"#8C3B9B":"#E4E4E4"}),(function(e){return!e.isEmoticonOnly&&"content: ''"})),D=f.b.div(R()),L=f.b.div(N(),(function(e){return e.isAuthor?"#ffffffe6":"#000000"}),(function(e){return e.isAuthor?"#ffffffe6":"#8C3B9B"})),B=f.b.span(M(),(function(e){return e.hasFiles?"200px":"auto"}),(function(e){return e.hasFiles?"7px 4px 5px 6px":"0"}),(function(e){return e.hasFiles?"200px":"auto"}),(function(e){return e.hasFiles?"0px 3px":"0"}),(function(e){return e.isAuthor?"#ffffff":e.theme.colors.primary}),(function(e){return e.isAuthor?"#ffffff":e.theme.colors.primary}),(function(e){return e.isAuthor?"#ffffff":"#8C3B9B"}),(function(e){return e.isAuthor?"#fff":"#0056b3"}),(function(e){return e.isAuthor?"#fff":"#0056b3"}),(function(e){return e.isAuthor?"#fff":"#0056b3"})),G=f.b.div(k(),(function(e){return e.isAuthor?"row":"row-reverse"}),(function(e){return e.isAuthor?"left":"right"})),z=f.b.div(j(),(function(e){return!e.isEmoticonOnly&&"\n    &:before {\n        ".concat((function(e){return e.showAvatar&&"content: ''"}),";\n        border: 10px solid transparent;\n        border-left-color: #f0f0f0;\n        position: absolute;\n        top: 6px;\n        left: -15px;\n        z-index: 1;\n        ").concat((function(e){return!0===e.isAuthor&&"\n            left: auto;\n            right: -15px;\n            border-left-color: red;\n            border-left-color: #7A1B8B;\n            border-right-color: transparent;\n        "}),";\n        width: 20px;\n        height: 20px;\n    }\n    ")}),(function(e){return e.isAuthor?"margin-left: 30px":"margin-right: 30px"}),(function(e){return e.isAuthor,"#ff4444"})),H=f.b.div(C(),(function(e){return e.isAuthor?"row":"row-reverse"}),(function(e){return e.isAuthor&&" flex-end"}),(function(e){return e.isAuthor&&" flex-end"}),(function(e){return e.isAuthor?"0 10px 0 0":"0 0 0 0"}),(function(e){return e.showAvatar&&!1===e.hideBg||e.hasRemoveOnDlFiles||e.showAvatar&&e.hasFiles?"flex":"none"}),(function(e){return e.showAvatar&&!1===e.hideBg||e.hasRemoveOnDlFiles||e.showAvatar&&e.hasFiles?"#a7abc3":"#0000"})),P=f.b.span(O(),(function(e){return e.isAuthor?"right: 100%;":"left: 100%;"})),U=f.b.span(_(),(function(e){return e.isEmoticonOnly||e.isGifOnly||!0===e.hasFiles?"3px 9px 3px 9px":"0"})),q=[.1,.2,.3,.4,.5,.6,.7,.8,.9],W=u.a.memo((function(e){var n,t=e.reply,r=e.showAvatar,a=e.selectedChannel,i=e.showGifPlayer,o=e.isAuthor,s=e.addMessageRef,l=e.user,c=e.isLastChat,h=e.chatMessageActions,f=e.timeFormat,E=(e.chatSettings,e.dictionary),_=e.users,O=e.translated_channels,C=e.chat_language,j=e.translate,k=e.language,M=e.loadReplies,N=Object(m.g)();Object(w.a)({message:t,actions:h}),Object(v.a)({message:t,isAuthor:o,translate:a.is_translate,chat_language:C,actions:h,channel:a});var R=Object(x.d)({reply:t,dictionary:E,isAuthor:o,user:l,selectedChannel:a,users:_,translate:j,language:k,translated_channels:O,chat_language:C}),F=R.quoteAuthor,T=R.quoteBody,W=R.replyBody,K=R.hasMessage,J=R.isGifOnly,V=R.isEmoticonOnly,Y=t.files.length>0,Z=t.files.some((function(e){return e.remove_on_download})),Q={container:Object(p.useRef)(null),replyRef:Object(p.useRef)(null)},$=Object(p.useRef)(null),X=Object(d.b)({threshold:1}),ee=Object(b.a)(X,2),ne=ee[0],te=ee[1],re=Object(d.b)({threshold:q,skip:!c}),ae=Object(b.a)(re,3),ie=ae[0],oe=ae[1],se=ae[2],le=function(e){return e.preventDefault(),N.push(e.currentTarget.dataset.href),!1};Object(p.useEffect)((function(){var e=Q.container.current.querySelector("a.push");return e&&e.addEventListener("click",le,!0),function(){e&&e.removeEventListener("click",le,!0)}}),[]),Object(p.useEffect)((function(){"object"===typeof N.location.state&&N.location.state&&N.location.state.focusOn===t.code&&Q.container.current&&$.current&&(Q.container.current.scrollIntoView({block:"center"}),$.current&&$.current.classList.add("pulse"),N.push(N.location.pathname,null))}),[N.location.state,Q.container.current,$.current]),Object(p.useEffect)((function(){s&&te&&M&&M()}),[s,te,M]),Object(p.useEffect)((function(){c&&se&&(se.boundingClientRect.height-se.intersectionRect.height>=16?h.setLastMessageVisiblility({status:!1}):h.setLastMessageVisiblility({status:!0}))}),[c,se,oe]);var ce=t.user&&_[t.user.id]&&"external"===_[t.user.id].type&&!o,pe=a&&a.slug&&(null===(n=a.members.find((function(e){return e.id===t.user.id})))||void 0===n?void 0:n.slug)!==a.slug.slice(0,-7);return u.a.createElement(u.a.Fragment,null,u.a.createElement(S,{ref:Q.container,tabIndex:t.id,hasFiles:Y,className:"chat-bubble ql-editor ".concat(t.is_important&&"important"," ").concat(ce&&"external-chat"),showAvatar:r,isAuthor:o,hideBg:V||J||Y&&!K,hasGif:i,hasRemoveOnDlFiles:Z},u.a.createElement(u.a.Fragment,null,t.is_transferred&&u.a.createElement(P,{className:"small",isAuthor:o},u.a.createElement(g.u,{icon:"corner-up-right"}),t.is_from_email?u.a.createElement(u.a.Fragment,null,E.repliedViaEmail):u.a.createElement(u.a.Fragment,null," ",E.forwardedMessage)),u.a.createElement(G,{ref:s?ne:null,className:"chat-content-clap",isAuthor:o},u.a.createElement(z,{showAvatar:r,isAuthor:o,isEmoticonOnly:V,className:"chat-content animated slower",ref:$},!o&&r&&u.a.createElement(u.a.Fragment,null,u.a.createElement(U,{isEmoticonOnly:V,hasFiles:Y,isGifOnly:J,className:"chat-name-not-author-mobile ".concat(t.is_important&&"important"," ").concat(a.sharedSlug&&"text-dark font-weight-bold")},"BOT"===t.user.type&&t.user.code&&t.user.code.includes("huddle")?E.teamFeedback:t.user.name,a.sharedSlug&&pe&&u.a.createElement(g.u,{icon:"repeat",height:14}))),t.quote&&t.quote.hasOwnProperty("body")&&!t.is_deleted&&(void 0!==t.quote.user_id||void 0!==t.quote.user)&&u.a.createElement(I,{className:"quote-container",showAvatar:r,isEmoticonOnly:V,hasFiles:Y,onClick:function(e){if(t.quote){var n=document.querySelector(".chat-list-item-".concat(t.quote.id));n&&n.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}},isAuthor:o},t.quote.user_id===l.id?u.a.createElement(D,{isAuthor:!0},"You"):u.a.createElement(D,{isAuthor:t.quote.user_id===l.id},F),u.a.createElement(L,{className:"quote-content",isAuthor:o,dangerouslySetInnerHTML:{__html:T}})),K&&u.a.createElement("span",{ref:c?ie:null},u.a.createElement(B,{ref:Q.replyRef,hasFiles:Y,isAuthor:o,className:"reply-content ".concat(V?"emoticon-body":""," ").concat(t.is_deleted?"is-deleted":""," ").concat(t.body.startsWith("ZOOM_MESSAGE::{")?"zoom-msg":""),dangerouslySetInnerHTML:{__html:W}})),t.files.length>0&&!t.is_deleted&&u.a.createElement(y.a,{dictionary:E,isAuthor:o,files:t.files,type:"chat",topic_id:"TOPIC"===a.type?a.entity_id:null}),i&&u.a.createElement(g.c,{body:t.body,autoplay:!0})))),u.a.createElement(H,{className:"chat-timestamp d-lg-none",showAvatar:r,hideBg:V||J||Y&&!K,hasGif:i,isAuthor:o},u.a.createElement("div",{className:"reply-date created"},u.a.createElement("div",{className:"d-block time-format"},A.a.unix(t.created_at.timestamp).format("hh:mm A")),Z&&u.a.createElement("span",null,E.removeOnDownload)))),u.a.createElement(H,{className:"chat-timestamp d-none d-lg-flex",showAvatar:r,hideBg:V||J||Y&&!K,hasGif:i,isAuthor:o},u.a.createElement("span",{className:"reply-date created"},u.a.createElement("div",{className:"d-block"},f.todayOrYesterdayDate(t.created_at.timestamp)),Z&&u.a.createElement("span",null,E.removeOnDownload))))})),K=t(921),J=t(922),V=t(923),Y=t(933),Z=t(924),Q=t(14),$=t(13),X=t(24);function ee(){var e=Object(c.a)(["\n  color: #a7abc3;\n  font-style: italic;\n  font-size: 11px;\n  position: absolute;\n  top: 0;\n  left: calc(100% + 10px);\n  display: flex;\n  height: 100%;\n  align-items: center;\n  white-space: nowrap;\n"]);return ee=function(){return e},e}function ne(){var e=Object(c.a)(["\n  display: block;\n  width: 100%;\n  cursor: ",";\n  strong {\n    cursor: ",";\n  }\n"]);return ne=function(){return e},e}function te(){var e=Object(c.a)(["\n  display: block;\n  width: 100%;\n\n  .chat-file-notification {\n    b:hover {\n      text-decoration: underline;\n      cursor: pointer;\n    }\n  }\n\n  .push-link {\n    display: inline-block;\n    position: relative;\n    padding-bottom: 25px;\n    margin-bottom: -25px;\n    width: 100%;\n\n    &:before {\n      position: absolute;\n      left: -14px;\n      top: -7px;\n      bottom: 0;\n      width: 6px;\n      height: calc(100% - 5px);\n      background: ",';\n      content: "";\n      border-radius: 6px 0 0 6px;\n    }\n\n    .card-body {\n      margin-top: 0.5rem;\n      margin-bottom: 0.5rem;\n      padding: 1rem;\n      max-width: 95%;\n      display: block;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      font-size: 12px;\n    }\n\n    .open-post {\n      display: flex;\n      position: absolute;\n      right: -20px;\n      bottom: -10px;\n      justify-content: center;\n      align-items: center;\n      font-size: 12px;\n\n      svg {\n        margin-left: 0;\n        height: 12px;\n      }\n    }\n  }\n']);return te=function(){return e},e}var re=f.b.span(te(),(function(e){return"linear-gradient(180deg, ".concat(e.theme.colors.primary," 0%, ").concat(e.theme.colors.secondary," 100%)")})),ae=f.b.span(ne(),(function(e){return e.isPostNotification?"pointer":"auto"}),(function(e){return e.isMeetMessage?"pointer":"auto"})),ie=f.b.div(ee()),oe=[.1,.2,.3,.4,.5,.6,.7,.8,.9],se=u.a.memo((function(e){var n=e.reply,t=e.selectedChannel,r=e.isLastChat,a=e.chatMessageActions,i=e.user,o=e.timeFormat,s=e.dictionary,l=Object(x.Ib)(),c=Object(p.useRef)(),f=Object(m.g)(),g=Object(m.i)(),y=Object(h.c)(),v=Object(p.useRef)(!0),w=Object(p.useState)(!1),E=Object(b.a)(w,2),A=E[0],_=E[1],O=Object(h.d)((function(e){return e.workspaces.workspaces})),C=Object(x.eb)({dictionary:s,reply:n,selectedChannel:t,user:i}).parseBody,j=Object(d.b)({threshold:oe,skip:!r}),k=Object(b.a)(j,3),M=k[0],N=k[1],R=k[2];Object(p.useEffect)((function(){r&&R&&(R.boundingClientRect.height-R.intersectionRect.height>=16?a.setLastMessageVisiblility({status:!1}):a.setLastMessageVisiblility({status:!0}))}),[r,R,N]);var F=function(e){if(e.preventDefault(),n.body.startsWith("ZOOM_MEETING::{")&&!A){var r=document.getElementById("meetingSDKElement").firstChild;if(r&&r.classList.contains("react-draggable")){y(Object($.a)({type:"zoom_inprogress"}))}else{_(!0);var a=JSON.parse(n.body.replace("ZOOM_MEETING::","")),i={meetingNumber:a.meetingNumber,role:0,password:a.password,channel_id:t.id};l.generateSignature(i,(function(){v.current&&_(!1)}))}}return!1};Object(p.useEffect)((function(){var e=null;return n.body.startsWith("ZOOM_MEETING::{")&&(e=c.current.querySelector("strong"))&&e.addEventListener("click",F,!0),function(){e&&e.removeEventListener("click",F,!0)}}),[]);return u.a.createElement(re,{ref:r?M:null},u.a.createElement(ae,{id:"bot-".concat(n.id),onClick:function(){if(n.body.startsWith("UPLOAD_BULK::")){var e=JSON.parse(n.body.replace("UPLOAD_BULK::",""));e.files&&a.viewFiles(e.files)}else if(n.body.startsWith("POST_CREATE::")){if(""!==n.body.replace("POST_CREATE::","").trim()){var r=JSON.parse(n.body.replace("POST_CREATE::",""));if(t.sharedSlug){var i=O["".concat(t.entity_id,"-").concat(t.slug)];i&&(i.folder_id?(y(Object(X.cb)(i)),f.push("/shared-hub/posts/".concat(i.folder_id,"/").concat(i.folder_name,"/").concat(i.id,"/").concat(Object(Q.i)(i.name),"/post/").concat(r.post.id,"/").concat(Object(Q.i)(r.post.title)))):(y(Object(X.cb)(i)),f.push("/shared-hub/posts/".concat(i.id,"/").concat(Object(Q.i)(i.name),"/post/").concat(r.post.id,"/").concat(Object(Q.i)(r.post.title)))))}else g&&g.workspaceId?g.folderId?f.push("/hub/posts/".concat(g.folderId,"/").concat(g.folderName,"/").concat(g.workspaceId,"/").concat(Object(Q.i)(g.workspaceName),"/post/").concat(r.post.id,"/").concat(Object(Q.i)(r.post.title))):f.push("/hub/posts/".concat(g.workspaceId,"/").concat(Object(Q.i)(g.workspaceName),"/post/").concat(r.post.id,"/").concat(Object(Q.i)(r.post.title))):f.push("/posts/".concat(r.post.id,"/").concat(Object(Q.i)(r.post.title)))}}},ref:c,dangerouslySetInnerHTML:{__html:C},isPostNotification:n.body.includes("POST_CREATE::"),isMeetMessage:n.body.includes("ZOOM_MEETING::")||n.body.includes("DRIFF_TALK::")}),u.a.createElement(ie,{className:"chat-timestamp",isAuthor:!1},u.a.createElement("span",{className:"reply-date created"},o.todayOrYesterdayDate(n.created_at.timestamp))))})),le=t(121),ce=t(18),pe=t(77),ue=u.a.memo((function(e){var n=e.replyData,t=e.className,r=void 0===t?"":t,a=e.selectedChannel,i=e.dictionary,o=e.width,s=void 0===o?250:o,l=e.scrollComponent,c=Object(h.c)(),p=Object(x.hb)();return u.a.createElement(pe.c,{width:s,className:r,scrollRef:l},u.a.createElement("div",{onClick:function(){c(Object(ce.mb)(n.payload,(function(e,n){e&&p.error(i.errorSendingChat)})))}},i.resend),u.a.createElement("div",{onClick:function(){c(Object(ce.Hb)({id:n.id,channel_id:a.id}))}},i.delete))}));function de(){var e=Object(c.a)(["\n  display: flex;\n  flex-flow: column;\n  align-items: center;\n  .feather-google-meet {\n    width: 2rem;\n    height: 2rem;\n    margin-bottom: 0.25rem;\n  }\n  > span,\n  button {\n    margin-bottom: 0.25rem;\n  }\n  .text-muted {\n    font-size: 0.7rem;\n  }\n  .feather-copy {\n    width: 0.8rem;\n    height: 0.8rem;\n    margin-left: 0.25rem;\n    cursor: pointer;\n  }\n"]);return de=function(){return e},e}var he=f.b.div(de()),me=function(e){var n=e.reply,t=e.timeFormat,r=JSON.parse(n.body.replace("GOOGLE_MEETING::","")),a=Object(x.mb)()._t,i={googleMeetMessage:a("GOOGLE_MEET_CHAT_MESSAGE","This meeting is private to the participants in this channel"),userStartMeet:a("GOOGLE_MEET_USER_START","::name:: started a video meeting",{name:r.author.name}),joinMeeting:a("GOOGLE.JOIN_MEETING","Join Meeting")};return u.a.createElement(he,{className:"google-meeting"},u.a.createElement(g.u,{icon:"google-meet"}),u.a.createElement("span",null,i.userStartMeet),u.a.createElement("button",{className:"btn btn-primary",onClick:function(){window.open(r.google_meet_event.hangoutLink,"_blank")}},u.a.createElement(g.u,{icon:"user-plus",className:"mr-2"})," ",i.joinMeeting),u.a.createElement("span",{className:"text-muted"},i.googleMeetMessage),u.a.createElement("span",{className:"reply-date created text-muted"},t.todayOrYesterdayDate(n.created_at.timestamp)))},fe=t(83),ge=t(31);function be(){var e=Object(c.a)(["\n  display: flex;\n  flex-flow: column;\n  align-items: center;\n  .feather-google-meet {\n    width: 2rem;\n    height: 2rem;\n    margin-bottom: 0.25rem;\n  }\n  > span,\n  button {\n    margin-bottom: 0.25rem;\n  }\n  .btn.btn-primary {\n    background-color: ","!important;\n  }\n  .text-muted {\n    font-size: 0.7rem;\n  }\n  .feather-copy {\n    width: 0.8rem;\n    height: 0.8rem;\n    margin-left: 0.25rem;\n    cursor: pointer;\n  }\n"]);return be=function(){return e},e}var xe=f.b.div(be(),(function(e){return e.theme.colors.primary})),ye=function(e){var n,t=e.reply,r=e.timeFormat,i=e.channelId,o=e.channelTitle,s=e.type,l=e.selectedChannel,c=Object(h.c)(),d=Object(p.useState)(!1),m=Object(b.a)(d,2),f=m[0],y=m[1],v=Object(h.d)((function(e){return e.workspaces.sharedWorkspaces})),w=t.body.startsWith("DRIFF_TALK::"),E=l.slug?l.slug:function(){var e=localStorage.getItem("slug");if(e)return e;var n=window.location.host.split(".");return 3===n.length?(localStorage.setItem("slug",n[0]),n[0]):null}(),A=Object(fe.b)();w?n=JSON.parse(t.body.replace("DRIFF_TALK::","")).author:n=JSON.parse(t.body.replace("MEETING_ENDED::","")).host;var _=Object(x.mb)()._t,O={driffTalkMessage:_("DRIFF_TALK_CHAT_MESSAGE","This call is private to the participants in this channel"),userStartMeet:_("DRIFF_TALK_USER_START","::name:: started a video meeting",{name:n.name}),joinMeeting:_("JOIN_MEETING","Join Meeting"),meetingEnded:_("MEETING_ENDED","Meeting ended")};return u.a.createElement(xe,{className:"google-meeting"},u.a.createElement(g.u,{icon:"video"}),u.a.createElement("span",null,O.userStartMeet),w?u.a.createElement("button",{className:"btn btn-primary",onClick:function(){if(!f&&w){y(!0);var e=JSON.parse(t.body.replace("DRIFF_TALK::","")),n=o.replace(/[&\/\\#, +()$~%.'":*?<>{}]/g,"_"),r="DIRECT"===s?"Meeting_Room":n;y(!0);var p={channel_id:i,host:!1,room_name:e.meet_event.room_name?e.meet_event.room_name:E+"~"+r+"~"+i};if(l.slug&&v[E]){var u={slug:E,token:v[E].access_token,is_shared:!0};p=Object(a.a)(Object(a.a)({},p),{},{sharedPayload:u})}"mobile"===ge.deviceType&&"WebKit"===ge.browserName||ge.isTablet&&"WebKit"===ge.browserName||ge.isIPad13&&"WebKit"===ge.browserName?c(Object(ce.v)(p,(function(e,n){e||window.webkit.messageHandlers.startDriffTalk.postMessage({slug:A,status:"OK",token:n.data._token,room:n.data.room_name})}))):c(Object(ce.u)(p,(function(){return y(!1)})))}}},u.a.createElement(g.u,{icon:"user-plus",className:"mr-2"})," ",O.joinMeeting):u.a.createElement("button",{className:"btn btn-secondary",disabled:!0},O.meetingEnded),u.a.createElement("span",{className:"text-muted"},O.driffTalkMessage),u.a.createElement("span",{className:"reply-date created text-muted"},r.todayOrYesterdayDate(t.created_at.timestamp)))};function ve(){var e=Object(c.a)(["\n  display: flex;\n  flex-flow: column;\n  align-items: center;\n  .feather-google-meet {\n    width: 2rem;\n    height: 2rem;\n    margin-bottom: 0.25rem;\n  }\n  > span,\n  button {\n    margin-bottom: 0.25rem;\n  }\n  .btn.btn-primary {\n    background-color: ","!important;\n  }\n  .text-muted {\n    font-size: 0.7rem;\n  }\n  .feather-copy {\n    width: 0.8rem;\n    height: 0.8rem;\n    margin-left: 0.25rem;\n    cursor: pointer;\n  }\n"]);return ve=function(){return e},e}var we=f.b.div(ve(),(function(e){return e.theme.colors.primary})),Ee=function(){var e=localStorage.getItem("slug");if(e)return e;var n=window.location.host.split(".");return 3===n.length?(localStorage.setItem("slug",n[0]),n[0]):null},Ae=function(e){var n=e.reply,t=e.timeFormat,r=e.channelId,a=e.channelTitle,i=e.type,o=Object(h.c)(),s=Object(p.useState)(!1),l=Object(b.a)(s,2),c=l[0],d=l[1],m=JSON.parse(n.body.replace("DUE_REMINDER::",""));console.log(m);var f=Object(x.mb)()._t,y={videoReminderMessage:f("SCHEDULED_DRIFF_TALK_CHAT_MESSAGE","Grab some coffe, check your hair and join the call. This call is private to the participants in this channel"),joinMeeting:f("JOIN_MEETING","Join Meeting"),meetingEnded:f("MEETING_ENDED","Meeting ended"),scheduleMeet:f("DRIFF_TALK_SCHEDULE_MEETING","Scheduled meeting is starting")};return u.a.createElement(we,{className:"google-meeting"},u.a.createElement(g.u,{icon:"video"}),u.a.createElement("span",null,y.scheduleMeet),u.a.createElement("button",{className:"btn btn-primary",onClick:function(){if(!c){d(!0);var e=a.replace(/[&\/\\#, +()$~%.'":*?<>{}]/g,"_"),n="DIRECT"===i?"Meeting_Room":e,t={channel_id:r,host:!1,room_name:Ee()+"~"+n+"~"+r+"~"+m[0].remind_at.timestamp};"mobile"===ge.deviceType&&"WebKit"===ge.browserName?o(Object(ce.v)(t,(function(e,n){e||window.webkit.messageHandlers.startDriffTalk.postMessage({token:n.data._token,room:n.data.room_name})}))):o(Object(ce.u)(t,(function(){return d(!1)})))}}},u.a.createElement(g.u,{icon:"calendar",className:"mr-2"})," ",y.joinMeeting),u.a.createElement("span",{className:"text-muted"},y.videoReminderMessage),u.a.createElement("span",{className:"reply-date created text-muted"},t.todayOrYesterdayDate(n.created_at.timestamp)))};function _e(){var e=Object(c.a)(["\n  display: flex;\n  align-self: flex-start;\n  margin-left: 3rem;\n"]);return _e=function(){return e},e}function Oe(){var e=Object(c.a)(["\n  display: flex;\n  flex-direction: column;\n  -webkit-box-align: center;\n  align-items: center;\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  svg {\n    max-width: 100%;\n    width: 100%;\n    max-height: 40%;\n    margin: auto;\n  }\n"]);return Oe=function(){return e},e}function Ce(){var e=Object(c.a)(["\n  align-self: flex-start;\n  margin-top: ",";\n\n  @media (max-width: 620px) {\n    display: none;\n  }\n  .pixel-avatar {\n    padding-top: 2px !important;\n  }\n"]);return Ce=function(){return e},e}function je(){var e=Object(c.a)(["\n  width: 100%;\n  ul {\n    margin: 0;\n  }\n"]);return je=function(){return e},e}function ke(){var e=Object(c.a)(["\n  display: flex;\n  justify-content: center;\n  &.initial-load {\n    position: absolute;\n    top: 45%;\n    left: 45%;\n    transform: translate(-45%, -45%);\n  }\n"]);return ke=function(){return e},e}function Me(){var e=Object(c.a)(["\n  position: relative;\n  display: inline-flex;\n  border-radius: 8px;\n  background: #f4f4f4f4;\n  text-align: left;\n  min-width: 100px;\n  max-width: 100%;\n  padding: 7px 15px;\n  line-height: 1.5rem;\n  float: left;\n  align-items: center;\n  justify-content: flex-end;\n  flex-flow: ",";\n  .chat-options {\n    visibility: hidden;\n  }\n  :hover {\n    .chat-options {\n      visibility: visible;\n    }\n  }\n  @media (max-width: 620px) {\n    padding: 7px;\n  }\n"]);return Me=function(){return e},e}function Ne(){var e=Object(c.a)(["\n  //width: 100%;\n  //overflow: hidden;\n  max-width: 75%;\n  position: relative;\n  flex-flow: column;\n  display: inherit;\n  margin-left: ",";\n  > img {\n    max-height: 300px;\n    max-width: 100%;\n    width: auto;\n    object-fit: cover;\n  }\n  .edited-message {\n    color: #aab0c8;\n    font-style: italic;\n    display: flex;\n    align-items: center;\n    font-size: 12px;\n    position: absolute;\n    top: 50%;\n    margin: 0 10px;\n    height: 25px;\n    white-space: nowrap;\n    ",";\n  }\n  .chat-options {\n    visibility: hidden;\n  }\n  .chat-options.active {\n    visibility: visible;\n  }\n  :hover {\n    .chat-options {\n      visibility: visible;\n    }\n  }\n  @media (max-width: 991.99px) {\n    max-width: calc(100% - 110px);\n  }\n\n  @media (max-width: 620px) {\n    ",";\n    ",";\n  }\n  margin-right: ",";\n  @media (min-width: 768px) {\n    margin-right: ",";\n  }\n"]);return Ne=function(){return e},e}function Re(){var e=Object(c.a)(["\n  flex-flow: ",";\n  flex-wrap: wrap;\n  ",";\n  min-width: 150px;\n  color: #a7abc3;\n  background: #ffffff;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  top: 0;\n  ",";\n  height: calc(100% + 4px);\n  margin-top: -2px;\n  transition: opacity 0.3s ease;\n  button {\n    margin: 5px;\n  }\n"]);return Re=function(){return e},e}function Fe(){var e=Object(c.a)(["\n  flex-flow: ",";\n  flex-wrap: wrap;\n  ",";\n  min-width: 150px;\n  color: #a7abc3;\n  background: #ffffff;\n  position: absolute;\n  display: flex;\n  align-items: center;\n  top: 0;\n  ",";\n  height: ",";\n  margin-top: -2px;\n  transition: opacity 0.3s ease;\n"]);return Fe=function(){return e},e}function Te(){var e=Object(c.a)(["\n  display: flex;\n  width: 100%;\n  align-items: center;\n  justify-content: flex-end;\n  flex-flow: column;\n  flex-flow: ",";\n  margin-left: ",";\n  ",";\n  margin-top: ",";\n  margin-top: ",";\n  @media (max-width: 620px) {\n    margin-top: ",";\n    margin-top: ",";\n    ",";\n    ",";\n    ",";\n  }\n  &:before {\n    ",";\n    border: 10px solid transparent;\n    border-right-color: ",";\n    position: absolute;\n    top: ",";\n    left: 40px;\n    z-index: 1;\n    @media all and (max-width: 620px) {\n      display: none;\n    }\n    ",";\n  }\n  .dark & {\n    &:before {\n      display: none;\n    }\n  }\n  &.google-meet-message {\n    margin-left: 0;\n    margin-top: 1rem;\n    > div.chat-bubble-quote-div {\n      width: 100%;\n      border: 1px solid #dee2e6;\n      border-radius: 6px;\n      padding: 10px;\n    }\n  }\n"]);return Te=function(){return e},e}function Se(){var e=Object(c.a)(["\n  z-index: 2;\n  color: #a7abc3;\n  display: inline-block;\n  left: 50%;\n  position: sticky;\n  top: 10px;\n  transform: translateX(-50%);\n  span {\n    padding: 4px 8px;\n    display: inline-block;\n    font-size: 11px;\n    border-radius: 6px;\n    margin: 0 4px;\n    background: #f0f0f0;\n  }\n  &[stuck] {\n    &:before,\n    &:after {\n      display: none;\n    }\n  }\n"]);return Se=function(){return e},e}function Ie(){var e=Object(c.a)(["\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  margin-bottom: ",";\n  text-align: center;\n  .chat-actions-container {\n    opacity: 0;\n  }\n\n  &:hover {\n    .chat-actions-container {\n      opacity: 1;\n    }\n  }\n  &.pulsating div.chat-bubble {\n    animation: blinker 2s linear forwards;\n    @keyframes blinker {\n      50% {\n        opacity: 0.5;\n      }\n    }\n  }\n"]);return Ie=function(){return e},e}function De(){var e=Object(c.a)(["\n  background: transparent;\n  background-repeat: repeat;\n  height: calc(100% - 125px);\n  overflow-y: auto;\n  overflow-x: hidden;\n  -webkit-overflow-scrolling: touch;\n  //z-index: 1;\n  scrollbar-width: none;\n  > ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n  .chat-message-options svg {\n    fill: currentColor;\n  }\n  .chat-message-options {\n    display: flex;\n    flex-direction: column;\n    flex-basis: 100%;\n    flex: 1;\n    margin: 5px;\n    max-width: 25px;\n\n    @media (max-width: 620px) {\n      margin-right: 0;\n    }\n\n    .more-options-tooltip {\n      &.orientation-bottom {\n        top: calc(100% - 35px);\n        @media (max-width: 620px) {\n          top: 100%;\n        }\n      }\n\n      &.orientation-top {\n        @media (max-width: 620px) {\n          bottom: 30px;\n        }\n      }\n\n      &.orientation-right {\n        left: calc(100% + 10px);\n        @media (max-width: 620px) {\n          left: 0;\n        }\n      }\n      &.orientation-left {\n        @media (max-width: 620px) {\n          left: auto;\n          right: 0;\n        }\n      }\n    }\n  }\n  &.is-processed {\n    opacity: 0;\n  }\n"]);return De=function(){return e},e}var Le=f.b.div(De()),Be=f.b.li(Ie(),(function(e){return e.isLastChat?"20px":"5px"})),Ge=f.b.div(Se()),ze=f.b.div(Te(),(function(e){return e.isAuthor?"row":"row-reverse"}),(function(e){return e.isAuthor||e.showAvatar?"0":"32px"}),(function(e){return!0===e.isAuthor&&"position: relative; right: 15px;"}),(function(e){return e.showAvatar&&"36px"}),(function(e){return e.showAvatar&&e.isAuthor&&"20px"}),(function(e){return e.showAvatar&&"12px"}),(function(e){return e.showAvatar&&e.isAuthor&&"8px"}),(function(e){return!e.showAvatar&&!e.isAuthor&&!e.isBot&&"margin-left: 0"}),(function(e){return!0===e.isAuthor&&!e.showAvatar&&"position: relative; right: 0px;"}),(function(e){return!0===e.isAuthor&&"position: relative; right: 0px;"}),(function(e){return e.showAvatar&&"content: '';"}),(function(e){return function(e){var n="#f0f0f0";return e.sharedSlug&&!e.isAuthor&&e.isNotSameDriff&&(n="#fb3"),e.isImportant&&(n="#7B68EE"),e.isExternalChat&&(n=e.theme.colors.fourth),n}(e)}),(function(e){return e.showAvatar&&!e.isAuthor?"45px":"8px"}),(function(e){return!0===e.isAuthor&&"\n            left: auto;\n            right: -16px;\n            border-left-color:  ".concat((function(e){return e.isImportant?"#7B68EE":"#7A1B8B"}),";\n            border-right-color: transparent;\n            @media all and (max-width: 620px) {\n              display: none;\n            }\n        ")})),He=f.b.div(Fe(),(function(e){return e.isAuthor?"row-reverse":"row"}),(function(e){return e.isAuthor?"margin-right: 10px":"margin-left: 10px"}),(function(e){return e.isAuthor?"right: 100%":"left: 100%"}),(function(e){return e.hasReactions?"calc(100% - 20px)":"calc(100% + 4px)"})),Pe=f.b.div(Re(),(function(e){return e.isAuthor?"row-reverse":"row"}),(function(e){return e.isAuthor?"margin-right: 10px":"margin-left: 10px"}),(function(e){return e.isAuthor?"right: 100%":"left: 100%"})),Ue=f.b.div(Ne(),(function(e){return e.showAvatar&&!e.isAuthor?"1rem":"1.6rem"}),(function(e){return e.isAuthor?"right: 100%;":"left: 100%"}),(function(e){return!e.showAvatar&&!e.isAuthor&&"margin-left: 0"}),(function(e){return!0===!e.isAuthor&&"margin-left: 0"}),(function(e){return e.showAvatar&&!e.isAuthor?"3rem":"1.6rem"}),(function(e){return e.showAvatar&&!e.isAuthor?"1rem":"1.6rem"})),qe=f.b.div(Me(),(function(e){return e.isAuthor?"row":"row-reverse"})),We=f.b.div(ke()),Ke=f.b.div(je()),Je=Object(f.b)(g.a)(Ce(),(function(e){return!0===e.isForwardedMessage?"25px":"0"})),Ve=f.b.div(Oe()),Ye=f.b.div(_e()),Ze=function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(e){var r;return Object(i.a)(this,t),(r=n.call(this,e)).loadReplies=function(){var e=r.props,n=e.selectedChannel,t=e.chatMessageActions;if(!n.isFetching&&n.hasMore){t.channelActions.fetchingMessages(n,!0);var a={skip:0,limit:20};"undefined"!==typeof n.replies&&(a={skip:0===n.skip&&n.replies.length?n.replies.length:n.skip,limit:20}),t.fetch(n,a,(function(e,r){e&&t.channelActions.fetchingMessages(n,!1)}))}},r.handleReadChannel=function(){if(r.props.unreadCount>0||r.props.selectedChannel.total_unread>0){var e=r.props,n=e.selectedChannel;e.chatMessageActions.channelActions.markAsRead(n)}},r.handleResendMessage=function(e){r.props.createChatMessageV2Action(e,(function(n,t){n&&r.props.onFailedMessageSend(e)}))},r.handleRemoveReply=function(e){r.props.cbOnRemoveReply(e)},r.handleEditReply=function(e){r.props.onEditReply(e)},r.handleQuoteReply=function(e){r.props.onSelectQuote(e)},r.handleLoadMoreRefChange=function(e,n){e&&r.loadReplies()},r.handleShowSeenUsers=function(){return r.setState({showSeenUsers:!r.state.showSeenUsers})},r.filterSeenMembers=function(){return r.props.selectedChannel.members.filter((function(e){return 2===r.props.selectedChannel.members.length?!(!r.props.selectedChannel.last_reply||!r.props.selectedChannel.last_reply.user)&&(r.props.selectedChannel.last_reply.user.id===r.props.user.id?!(r.props.user.id===e.id):!(r.props.selectedChannel.last_reply.user.id===e.id)):(!r.props.selectedChannel.last_reply||!r.props.selectedChannel.last_reply.user||r.props.selectedChannel.last_reply.user.id!==e.id)&&r.props.user.id!==e.id})).filter((function(e){return!!e.last_visited_at&&e.last_visited_at.timestamp>=r.props.selectedChannel.last_reply.created_at.timestamp}))},r.getLoadRef=function(e){var n=r.props.selectedChannel,t=!1;if(n.replies.length&&!n.isFetching){var a=n.replies.findIndex((function(n){return n.id===e}));a<Math.round(n.replies.length/2)&&a%2===0&&(t=!0)}return t},r.gMessages=Object(le.a)((function(e){return Object.entries(e.filter((function(e){return e.channel_id===r.props.selectedChannel.id})).sort((function(e,n){return e.created_at.timestamp-n.created_at.timestamp===0?e.id-n.id:e.created_at.timestamp-n.created_at.timestamp})).map((function(e,n){return e.hasOwnProperty("g_date")?Object(a.a)(Object(a.a)({},e),{},{isLastChat:n===r.props.selectedChannel.replies.length-1}):Object(a.a)(Object(a.a)({},e),{},{g_date:r.props.timeFormat.localizeDate(e.created_at.timestamp,"YYYY-MM-DD"),isLastChat:n===r.props.selectedChannel.replies.length-1})})).reduce((function(e,n){var t=n.g_date;return e[t]=e[t]||[],e[t].push(n),e}),{}))})),r.state={},r.scrollComponent=u.a.createRef(),r}return Object(o.a)(t,[{key:"componentWillUnmount",value:function(){var e=this.scrollComponent.current;this.props.chatMessageActions.channelActions.saveHistoricalPosition(this.props.selectedChannel.id,e)}},{key:"componentDidMount",value:function(){var e=this.props,n=e.selectedChannel,t=e.historicalPositions,r=this.scrollComponent.current;"object"!==typeof this.props.history.location.state&&(t.length?t.forEach((function(e){e.channel_id===n.id&&r&&(r.scrollTop=r.scrollHeight-e.scrollPosition)})):r&&(r.scrollTop=r.scrollHeight)),n.hasMore&&0===n.skip&&this.loadReplies(),n.is_read&&this.handleReadChannel()}},{key:"getSnapshotBeforeUpdate",value:function(e,n){var t=this.props.selectedChannel,r=this.scrollComponent.current;return e.selectedChannel&&e.selectedChannel&&e.selectedChannel.replies&&t.replies&&r&&t.replies.length>20&e.selectedChannel.replies.length<t.replies.length&&t.replies.length-e.selectedChannel.replies.length>=2?r.scrollHeight-r.scrollTop:null}},{key:"componentDidUpdate",value:function(e,n,t){var r=this.props,a=r.selectedChannel,i=r.historicalPositions,o=this.scrollComponent.current;(this.props.selectedChannel&&e.selectedChannel.code!==a.code&&(a.hasMore&&0===a.skip&&this.loadReplies(),this.handleReadChannel(),i.length&&i.forEach((function(e){e.channel_id===a.id&&o&&(o.scrollTop=o.scrollHeight-e.scrollPosition)}))),a&&e.selectedChannel.id===this.props.selectedChannel.id)&&(null!==t&&a.replies.length!==e.selectedChannel.replies.length&&(a.replies.length-e.selectedChannel.replies.length===1?a.last_reply&&a.last_reply.user&&a.last_reply.user.id!==this.props.user.id&&(this.props.isLastChatVisible||(o.scrollTop=o.scrollHeight-t)):o.scrollTop=o.scrollHeight-t),a.replies&&a.replies.length&&a.replies.length-e.selectedChannel.replies.length===1&&(a.last_reply&&a.last_reply.user&&a.last_reply.user.id===this.props.user.id?o&&(o.scrollTop=o.scrollHeight):this.props.isLastChatVisible&&!this.props.isIdle&&this.props.isBrowserActive&&document.hasFocus()&&(a.is_read&&this.props.chatMessageActions.channelActions.markAsRead(a),o&&(o.scrollTop=o.scrollHeight))),a&&0===e.selectedChannel.skip&&a.replies.length>0&&0!==a.skip&&(o.scrollTop=o.scrollHeight,o.scrollHeight<o.scrollHeight&&(o.scrollTop=o.scrollHeight)));this.props.unreadCount>0&&this.props.isLastChatVisible&&!this.props.isIdle&&this.props.isBrowserActive&&document.hasFocus()&&this.handleReadChannel()}},{key:"render",value:function(){var e=this,n=0,t=this.gMessages(this.props.selectedChannel.replies);return u.a.createElement(Le,{ref:this.scrollComponent,id:"component-chat-thread",className:"component-chat-thread messages ".concat(this.props.className),tabIndex:"2"},this.props.selectedChannel.isFetching&&this.props.selectedChannel.hasMore&&0===this.props.selectedChannel.replies.length&&0===this.props.selectedChannel.skip&&u.a.createElement(We,{className:"initial-load"},u.a.createElement(g.k,null)),u.a.createElement(Ke,{className:"infinite-scroll",id:"infinite-scroll-chat-replies"},this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length>=20&&u.a.createElement(d.a,{as:"div",onChange:function(n,t){return e.handleLoadMoreRefChange(n,t)}},u.a.createElement("span",{className:"intersection-load-more-ref"})),u.a.createElement("ul",null,this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length?t.map((function(t,a){return u.a.createElement("div",{key:"".concat(e.props.selectedChannel.code+t[0])},u.a.createElement(Ge,{className:"timestamp-container"},u.a.createElement("span",null,e.props.timeFormat.localizeChatDate(t[1][0].created_at.timestamp,"ddd, MMM DD, YYYY"))),t[1].map((function(t,a,i){var o,s=t.user&&t.user.id===e.props.user.id;e.props.selectedChannel.slug&&e.props.sharedWorkspaces[e.props.selectedChannel.slug]&&(s=t.user&&t.user.id===e.props.sharedWorkspaces[e.props.selectedChannel.slug].user_auth.id);var l=!1,c=!1,p=!1,d=!1,h=!1,m=!1,f=[],g=!1;if(t.user){if(t.created_at.timestamp&&(0===a&&(c=!0,l=!0),0!==a&&e.props.timeFormat.localizeDate(i[a-1].created_at.timestamp,"D")!==e.props.timeFormat.localizeDate(t.created_at.timestamp,"D")&&(c=!0,l=!0),0!==a&&t.created_at.timestamp-i[a-1].created_at.timestamp>600&&(l=!0)),0!==a&&!0===i[a-1].is_read&&!1===t.is_read&&(h=!0),0!==a&&null===i[a-1].user&&(l=!0),n!==t.user.id&&(l=!0,n=t.user.id),"undefined"!==typeof t.body&&null!==t.body&&null!==t.body.match(Q.b)&&(p=!0),t.files&&t.files.length>0&&i[a+1]&&i[a+1].user&&i[a+1].user.id===t.user.id&&i[a-1]&&0===i[a-1].files.length||l&&t.files&&t.files.length>0){m=!0;var b=i[a+1]?i[a+1].files:[];f=[].concat(Object(r.a)(t.files),Object(r.a)(b));for(var x=2;i[a+x]&&(!i[a+x].user||i[a+x].user.id===t.user.id);)f=[].concat(Object(r.a)(f),Object(r.a)(i[a+x].files)),x++}d=["gripp_bot_account","gripp_bot_invoice","gripp_bot_offerte","gripp_bot_project","gripp_bot_account","driff_webhook_bot","huddle_bot"].includes(t.user.code)}else if(t.body.startsWith("DUE_REMINDER::")){var y=JSON.parse(t.body.replace("DUE_REMINDER::",""));y.length&&"DRIFF_TALK"===y[0].link_type&&(g=!0)}return u.a.createElement(Be,{key:e.props.selectedChannel.code+t.id,className:"chat-list chat-list-item-".concat(t.id," code-").concat(t.code),showTimestamp:c,isLastChat:t.isLastChat},t.user&&h&&e.props.unreadCount>0&&u.a.createElement(J.a,null),t.user&&u.a.createElement(ze,{isAuthor:s,className:"chat-reply-list-item chat-reply-list-item-".concat(t.id," ").concat(s?"chat-right":"chat-left"),showAvatar:l,isBot:d,isImportant:t.is_important,isExternalChat:t.user&&e.props.users[t.user.id]&&"external"===e.props.users[t.user.id].type&&!s,sharedSlug:!!e.props.selectedChannel.hasOwnProperty("sharedSlug")&&e.props.selectedChannel.sharedSlug,isNotSameDriff:e.props.selectedChannel.sharedSlug&&e.props.selectedChannel.slug&&(null===(o=e.props.selectedChannel.members.find((function(e){return e.id===t.user.id})))||void 0===o?void 0:o.slug)!==e.props.selectedChannel.slug.slice(0,-7)},u.a.createElement(Ue,{isAuthor:s,showAvatar:l,className:"chat-bubble-quote-div"},u.a.createElement(W,{chatMessageActions:e.props.chatMessageActions,timeFormat:e.props.timeFormat,user:e.props.user,reply:t,showAvatar:l,selectedChannel:e.props.selectedChannel,showGifPlayer:p,isAuthor:s,addMessageRef:e.getLoadRef(t.id),isLastChat:t.isLastChat,loadReplies:e.loadReplies,chatSettings:e.props.settings,dictionary:e.props.dictionary,users:e.props.users,translate:e.props.translate,language:e.props.language,translated_channels:e.props.translated_channels,chat_language:e.props.chat_language}),u.a.createElement(He,{isAuthor:s,className:"chat-actions-container ".concat(t.reactions.length&&"has-reactions"),hasReactions:t.reactions.length},!isNaN(t.id)&&u.a.createElement(V.a,{isAuthor:s,reply:t,scrollComponent:e.scrollComponent.current,chatMessageActions:e.props.chatMessageActions}),!isNaN(t.id)&&!t.is_deleted&&u.a.createElement(K.a,{dictionary:e.props.dictionary,className:"chat-message-options",selectedChannel:e.props.selectedChannel,scrollComponent:e.scrollComponent.current,isAuthor:s,replyData:t,teamChannelId:e.props.teamChannelId,isExternalUser:"external"===e.props.user.type,chatMessageActions:e.props.chatMessageActions,showDownloadAll:m,downloadFiles:f}),isNaN(t.id)&&"failed"===t.status&&u.a.createElement(ue,{dictionary:e.props.dictionary,className:"chat-message-options",selectedChannel:e.props.selectedChannel,scrollComponent:e.scrollComponent.current,replyData:t})),t.reactions.length>0&&u.a.createElement(Y.a,{reactions:t.reactions,isAuthor:s,reply:t,loggedUser:e.props.user,chatReactionAction:e.props.chatReactionV2Action}),e.props.selectedChannel.last_reply&&e.props.selectedChannel.last_reply.id===t.id&&e.filterSeenMembers().length>0&&u.a.createElement(Z.a,{isAuthor:s,onClick:e.handleShowSeenUsers,seenMembers:e.filterSeenMembers(),isPersonal:2===e.props.selectedChannel.members.length,channel:e.props.selectedChannel})),!s&&l&&u.a.createElement(Je,{isForwardedMessage:t.is_transferred,id:t.user.id,type:"USER",imageLink:t.user.profile_image_link,name:t.user.name,isBot:d,isHuddleBot:"huddle_bot"===t.user.code,showSlider:!0,sharedUser:e.props.selectedChannel.sharedSlug&&e.props.selectedChannel.members.find((function(e){return e.id===t.user.id}))?e.props.selectedChannel.members.find((function(e){return e.id===t.user.id})):null})),null===t.user&&!t.body.startsWith("GOOGLE_MEETING::")&&!t.body.startsWith("DRIFF_TALK::")&&!t.body.startsWith("MEETING_ENDED::")&&!g&&u.a.createElement(ze,{className:"chat-reply-list-item system-reply-list-item chat-reply-list-item-".concat(t.id),isAuthor:!1},u.a.createElement(Ue,{isAuthor:s,showAvatar:l,className:"chat-bubble-quote-div"},u.a.createElement(qe,{className:"system-message",isAuthor:!1},u.a.createElement(se,{user:e.props.user,chatMessageActions:e.props.chatMessageActions,timeFormat:e.props.timeFormat,selectedChannel:e.props.selectedChannel,reply:t,isLastChat:t.isLastChat,dictionary:e.props.dictionary,users:e.props.users}),u.a.createElement(Pe,{isAuthor:s,className:"chat-actions-container"},u.a.createElement(V.a,{isAuthor:s,reply:t,scrollComponent:e.scrollComponent.current,chatMessageActions:e.props.chatMessageActions}),!isNaN(t.id)&&!t.is_deleted&&u.a.createElement(K.a,{dictionary:e.props.dictionary,scrollComponent:e.scrollComponent.current,replyData:t,className:"chat-message-options",selectedChannel:e.props.selectedChannel,isAuthor:s,teamChannelId:e.props.teamChannelId,isExternalUser:"external"===e.props.user.type,chatMessageActions:e.props.chatMessageActions}))),t.reactions.length>0&&u.a.createElement(Y.a,{reactions:t.reactions,reply:t,isAuthor:!1,loggedUser:e.props.user,chatReactionAction:e.props.chatReactionV2Action}))),null===t.user&&t.body.startsWith("GOOGLE_MEETING::")&&u.a.createElement(ze,{className:"chat-reply-list-item system-reply-list-item chat-reply-list-item-".concat(t.id," google-meet-message justify-content-center"),isAuthor:!1},u.a.createElement(Ue,{isAuthor:s,showAvatar:l,className:"chat-bubble-quote-div"},u.a.createElement(me,{reply:t,timeFormat:e.props.timeFormat}))),null===t.user&&(t.body.startsWith("DRIFF_TALK::")||t.body.startsWith("MEETING_ENDED::"))&&u.a.createElement(ze,{className:"chat-reply-list-item system-reply-list-item chat-reply-list-item-".concat(t.id," google-meet-message justify-content-center"),isAuthor:!1},u.a.createElement(Ue,{isAuthor:s,showAvatar:l,className:"chat-bubble-quote-div"},u.a.createElement(ye,{reply:t,timeFormat:e.props.timeFormat,selectedChannel:e.props.selectedChannel,channelId:e.props.selectedChannel.id,channelTitle:e.props.selectedChannel.title,type:e.props.selectedChannel.type}))),null===t.user&&t.body.startsWith("DUE_REMINDER::")&&g&&u.a.createElement(ze,{className:"chat-reply-list-item system-reply-list-item chat-reply-list-item-".concat(t.id," google-meet-message justify-content-center"),isAuthor:!1},u.a.createElement(Ue,{isAuthor:s,showAvatar:l,className:"chat-bubble-quote-div"},u.a.createElement(Ae,{reply:t,timeFormat:e.props.timeFormat,channelId:e.props.selectedChannel.id,channelTitle:e.props.selectedChannel.title,type:e.props.selectedChannel.type}))))})))})):null,!this.props.selectedChannel.isFetching&&this.props.selectedChannel.replies&&this.props.selectedChannel.replies.length<1&&u.a.createElement(u.a.Fragment,null,u.a.createElement(Ve,{className:"no-reply-container"},u.a.createElement(g.s,{icon:3}),"PERSONAL_BOT"===this.props.selectedChannel.type&&u.a.createElement(Ye,null,u.a.createElement("div",null,u.a.createElement(g.u,{icon:"message_slack_alike"})),u.a.createElement("div",null,u.a.createElement("h5",null,this.props.dictionary.personalNoteHeaderText),u.a.createElement("p",null,this.props.dictionary.personalNoteDescription))))))))}}]),t}(u.a.PureComponent);n.default=Object(m.k)(Object(h.b)((function(e){var n=e.global,t=n.isIdle,r=n.isBrowserActive,a=e.session.user,i=e.chat,o=i.historicalPositions,s=i.isLastChatVisible,l=i.selectedChannel,c=e.users.users,p=e.workspaces.sharedWorkspaces;return{user:a,settings:e.settings.user.CHAT_SETTINGS,historicalPositions:o,isLastChatVisible:s,users:c,isIdle:t,isBrowserActive:r,selectedChannel:l,sharedWorkspaces:p}}),null)(Ze))}}]);