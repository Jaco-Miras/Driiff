(this.webpackJsonpdriff=this.webpackJsonpdriff||[]).push([[19],{715:function(e,t,n){"use strict";n.r(t);var a,l,i,c,s,r,o,u,m=n(9),d=n(0),b=n.n(d),p=n(10),f=n(5),g=n(41),E=n(11),_=p.a.ul(a||(a=Object(m.a)(["\n  .list-group-item:last-child {\n    border-bottom-width: thin !important;\n  }\n  li {\n    cursor: pointer;\n  }\n  &.list-group .list-group-item.active {\n    border-color: #eeebee;\n    background-color: #fafafa !important;\n    .dark & {\n      background-color: #111417 !important;\n    }\n  }\n"]))),h=function(e){var t=Object(E.a)().setAdminFilter,n=Object(g.g)(),a=Object(f.d)((function(e){return e.admin.filters})),l=function(e){e.persist(),t({filter:"quick-links"===e.target.dataset.value?"quick_links":e.target.dataset.value}),n.push("/admin-settings/".concat(e.target.dataset.value)),document.body.classList.remove("mobile-modal-open")};return b.a.createElement(_,{className:"list-group list-group-flush"},b.a.createElement("li",{className:"list-group-item d-flex align-items-center ".concat(a.automation?"active":""),"data-value":"automation",onClick:l},"Automation"),b.a.createElement("li",{className:"list-group-item d-flex align-items-center ".concat(a.quick_links?"active":""),"data-value":"quick-links",onClick:l},"Quick link menu"),b.a.createElement("li",{className:"list-group-item d-flex align-items-center ".concat(a.settings?"active":""),"data-value":"settings",onClick:l},"Settings"),b.a.createElement("li",{className:"list-group-item d-flex align-items-center ".concat(a.bots?"active":""),"data-value":"bots",onClick:l},"Bots"),b.a.createElement("li",{className:"list-group-item d-flex align-items-center ".concat(a.subscription?"active":""),"data-value":"subscription",onClick:l},"Subscription"),b.a.createElement("li",{className:"list-group-item d-flex align-items-center ".concat(a.contact?"active":""),"data-value":"contact",onClick:l},"Contact"),b.a.createElement("li",{className:"list-group-item d-flex align-items-center ".concat(a.support?"active":""),"data-value":"support",onClick:l},"Support desk"))},v=p.a.div(l||(l=Object(m.a)(["\n  .app-sidebar-menu {\n    overflow: hidden;\n    outline: currentcolor none medium;\n    @media (max-width: 991.99px) {\n      border-bottom-left-radius: 0 !important;\n      border-bottom-right-radius: 0 !important;\n      display: flex;\n      flex-direction: column;\n      .card-body {\n        display: none;\n      }\n      .create-new-post-wrapper {\n        border-top: 1px solid #ebebeb;\n        display: block;\n        order: 9;\n      }\n      .list-group-flush {\n        border-top: 1px solid #ebebeb;\n      }\n    }\n  }\n  @media (max-width: 991.99px) {\n    margin-bottom: 0 !important;\n  }\n"]))),O=function(e){return b.a.createElement(v,{className:"col-md-3 app-sidebar bottom-modal-mobile"},b.a.createElement("div",{className:"mobile-overlay",onClick:function(){document.body.classList.remove("mobile-modal-open")}}),b.a.createElement("div",{className:"bottom-modal-mobile_inner"},b.a.createElement("div",{className:"app-sidebar-menu",tabIndex:"2"},b.a.createElement("div",{className:"post-filter-item list-group list-group-flush"},b.a.createElement("span",{className:"list-group-item d-flex align-items-center pr-3","data-value":"inbox"},b.a.createElement("h4",null,"Admin menu"))),b.a.createElement(h,null))))},j=n(8),k=n(1),N=n(7),L=n(75),D=n(53),A=p.a.div(i||(i=Object(m.a)(["\n  padding: 1rem;\n  > div {\n    margin-bottom: 1rem;\n  }\n"]))),S=function(){var e=Object(E.cb)()._t,t=Object(E.X)(),n={loginSettings:e("ADMIN.LOGIN_SETTINGS","Login settings"),googleLogin:e("ADMIN.GOOGLE_LOGIN","Google login"),magicLink:e("ADMIN.MAGIC_LINK","Magic link"),signUp:e("ADMIN.SIGN_UP","Sign up"),passwordLogin:e("ADMIN.PASSWORD_LOGIN","Password login"),saveLogin:e("ADMIN.SAVE_LOGIN","Save login"),enable:e("LABEL.ENABLE","Enable"),disable:e("LABEL.DISABLE","Disable"),loginSettingsUpdated:e("TOAST.LOGIN_SETTINGS_SUCCESS","Login settings updated")},a=Object(d.useRef)(!0),l=Object(f.d)((function(e){return e.settings.user.GENERAL_SETTINGS})).dark_mode,i=Object(f.d)((function(e){return e.admin.login})),c=Object(f.d)((function(e){return e.admin.loginFetched})),s=Object(f.d)((function(e){return e.admin.filters})),r=Object(E.a)(),o=r.fetchLoginSettings,u=r.updateLoginSettings,m=r.setAdminFilter,p=Object(d.useState)(Object(k.a)({},i)),g=Object(N.a)(p,2),_=g[0],h=g[1],v=Object(d.useState)(!1),O=Object(N.a)(v,2),S=O[0],C=O[1];Object(d.useEffect)((function(){return m({filters:Object(k.a)(Object(k.a)({},s),{},{settings:!0})}),c||o({}),function(){a.current=!1}}),[]),Object(d.useEffect)((function(){h(i)}),[i]);var I=[{value:!1,label:n.disable},{value:!0,label:n.enable}],q=I.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{name:"google_login"})})),U=I.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{name:"magic_link"})})),y=I.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{name:"sign_up"})})),w=I.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{name:"password_login"})})),T=function(e){h(Object(k.a)(Object(k.a)({},_),{},Object(j.a)({},e.name,e.value)))};return b.a.createElement(A,null,b.a.createElement("h4",{className:"mb-3"},n.loginSettings),b.a.createElement("div",null,b.a.createElement("label",null,n.googleLogin),b.a.createElement(L.a,{styles:"0"===l?D.b:D.a,value:q.find((function(e){return e.value===_.google_login})),onChange:T,options:q})),b.a.createElement("div",null,b.a.createElement("label",null,n.magicLink),b.a.createElement(L.a,{styles:"0"===l?D.b:D.a,value:U.find((function(e){return e.value===_.magic_link})),onChange:T,options:U})),b.a.createElement("div",null,b.a.createElement("label",null,n.signUp),b.a.createElement(L.a,{styles:"0"===l?D.b:D.a,value:y.find((function(e){return e.value===_.sign_up})),onChange:T,options:y})),b.a.createElement("div",null,b.a.createElement("label",null,n.passwordLogin),b.a.createElement(L.a,{styles:"0"===l?D.b:D.a,value:w.find((function(e){return e.value===_.password_login})),onChange:T,options:w})),b.a.createElement("div",{className:"mt-2"},b.a.createElement("button",{className:"btn btn-primary",onClick:function(){C(!0),u(_,(function(e,l){a.current&&C(!1),e||t.success(n.loginSettingsUpdated)}))},disabled:S||!c},n.saveLogin)))},C=n(6),I=n(627),q=function(e){return/(?:(?:ht|f)tp(?:s?):\/\/|~\/|\/)?(?:\w+:\w+@)?((?:(?:[-\w\d{1-3}]+\.)+(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2}))|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[-\w~!$ |/.,*:;=]|%[a-f\d]{2})*)?/gi.test(e)},U=p.a.div(c||(c=Object(m.a)(["\n  padding: 1rem;\n  > div {\n    margin-bottom: 1rem;\n  }\n  table {\n    width: 100%;\n    border-spacing: 1rem;\n    th,\n    td {\n      padding: 5px 15px;\n    }\n  }\n  col.col1 {\n    width: 20%;\n  }\n  col.col2 {\n    width: 50%;\n  }\n"]))),y=function(){var e=Object(E.cb)()._t,t=Object(E.X)(),n={quickLinks:e("ADMIN.QUICK_LINKS_SETTINGS","Quick links settings"),saveQuickLinks:e("ADMIN.SAVE_QUICK_LINKS","Save quick links"),quickLinksUpdated:e("ADMIN.QUICK_LINKS_UPDATED","Quick links updated"),menuName:e("ADMIN.MENU_NAME","Menu name"),link:e("ADMIN.LINK","Link")},a=Object(d.useRef)(!0),l=Object(f.d)((function(e){return e.global.links})),i=Object(f.d)((function(e){return e.global.linksFetched})),c=Object(f.d)((function(e){return e.admin.filters})),s=Object(E.a)(),r=s.setAdminFilter,o=s.updateQuickLinks,u=s.createQuickLinks,m=Object(d.useState)(i&&l.length?Array.from(l):Array.from(Array(10),(function(){return{id:null,menu_name:"",link:""}}))),p=Object(N.a)(m,2),g=p[0],_=p[1],h=Object(d.useState)(!1),v=Object(N.a)(h,2),O=v[0],j=v[1];Object(d.useEffect)((function(){return r({filters:Object(k.a)(Object(k.a)({},c),{},{quick_links:!0})}),function(){a.current=!1}}),[]),Object(d.useEffect)((function(){_([].concat(Object(C.a)(l),Object(C.a)(g)).slice(0,10))}),[l]);return b.a.createElement(U,null,b.a.createElement("h4",{className:"mb-3"},n.quickLinks),b.a.createElement("div",null,b.a.createElement("table",null,b.a.createElement("colgroup",null,b.a.createElement("col",{className:"col1"}),b.a.createElement("col",{className:"col2"})),b.a.createElement("thead",null,b.a.createElement("tr",null,b.a.createElement("th",null,n.menuName),b.a.createElement("th",null,n.link))),b.a.createElement("tbody",null,g.map((function(e,t){return b.a.createElement("tr",{key:t},b.a.createElement("td",null,b.a.createElement(I.a,{className:"w-100",value:e.menu_name,onChange:function(e){return function(e,t){var n=Object(C.a)(g);n[t].menu_name=e.target.value,_(n)}(e,t)},disabled:O||!i,type:"url"})),b.a.createElement("td",null,b.a.createElement(I.a,{className:"w-100",value:e.link,onChange:function(e){return function(e,t){var n=Object(C.a)(g);n[t].link=e.target.value,_(n)}(e,t)},disabled:O||!i,type:"url"})))}))))),b.a.createElement("div",{className:"mt-2"},b.a.createElement("button",{className:"btn btn-primary",onClick:function(){j(!0);var e={quick_links:g.filter((function(e){return null!==e.id})).map((function(e){return""!==e.menu_name.trim()&&""!==e.link.trim()?e:Object(k.a)(Object(k.a)({},e),{},{menu_name:"",link:""})}))};if(o(e,(function(e,l){a.current&&j(!1),e||t.success(n.quickLinksUpdated)})),g.filter((function(e){return null===e.id})).length){var l={quick_links:g.filter((function(e){return null===e.id})).map((function(e){return{menu_name:e.menu_name,link:e.link}}))};u(l)}},disabled:!!O||!i||!!g.filter((function(e){return""!==e.link.trim()})).some((function(e){return!1===q(e.link)}))||!!g.some((function(e){return""===e.menu_name.trim()&&""!==e.link.trim()}))||!!g.some((function(e){return""!==e.menu_name.trim()&&""===e.link.trim()}))},n.saveQuickLinks)))},w=n(264),T=n.n(w),x=n(20),H=n(13),M=n(132),B=p.a.div(s||(s=Object(m.a)(["\n  overflow: auto;\n  &::-webkit-scrollbar {\n    display: none;\n  }\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n  .card {\n    height: 95%;\n  }\n"]))),G=Object(p.a)(T.a)(r||(r=Object(m.a)(["\n  .dark & {\n    input,\n    select {\n      color: #fff;\n    }\n    option {\n      color: #000;\n    }\n  }\n  .react-time-picker__inputGroup__minute {\n    width: 18px !important;\n  }\n"]))),Q=function(e){return(e<10?"0":"")+e},F=function(e){var t=Object(E.cb)()._t,n={huddleBot:t("HUDDLE.Question","Question"),huddleBotCreated:t("HUDDLE.HUDDLE_CREATED","Huddle bot created."),huddleBotUpdated:t("HUDDLE.HUDDLE_UPDATED","Huddle bot updated."),huddleBotFailed:t("HUDDLE.HUDDLE_FAILED","Huddle bot failed."),channels:t("HUDDLE.CHANNELS","Channels"),questions:t("HUDDLE.QUESTIONS","Questions"),startAt:t("HUDDLE.START_AT","Start at"),publishAt:t("HUDDLE.PUBLISH_AT","Publish at"),delete:t("HUDDLE.DELETE","Delete"),update:t("HUDDLE.UPDATE","Update"),create:t("HUDDLE.CREATE","Create"),cancel:t("HUDDLE.CANCEL","Cancel"),confirmationText:t("HUDDLE.DELETE_CONFIRMATION_TEXT","Are you sure you want to delete this huddle bot?"),deleteHuddle:t("HUDDLE.DELETE_HUDDLE","Delete huddle"),huddleLabel:t("ADMIN.HUDDLE_LABEL","Huddle bot")},a=Object(E.y)(),l=Object(E.X)(),i=Object(f.c)(),c=Object(f.d)((function(e){return e.chat.bots})),s=Object(f.d)((function(e){return e.chat.huddleBot})),r=c.channels,o=c.loaded,u=Object(f.d)((function(e){return e.admin.filters})),m=[{question:""},{question:""},{question:""},{question:""},{question:""}],p=new Date,g=Q(p.getHours())+":"+Q(p.getMinutes()),_=p.getTimezoneOffset()/60,h=Object(d.useState)([]),v=Object(N.a)(h,2),O=v[0],L=v[1],D=Object(d.useState)({set_start_at:g,set_publish_at:g,channel_id:null,user_bot_id:s?s.id:null,questions:m,introduction_message:"",closing_message:""}),A=Object(N.a)(D,2),S=A[0],C=A[1],I=r.map((function(e){return Object(k.a)(Object(k.a)({},e),{},{value:e.id,label:e.name,icon:"compass"})}));Object(d.useEffect)((function(){if(i(Object(M.e)({filters:Object(k.a)(Object(k.a)({},u),{},{bots:!0})})),!o){a.fetchUserBots({},(function(e,t){e||t.data.user_bots&&0===t.data.user_bots.length&&a.createUserBot({bot_name:"Huddle"})}))}}),[]);var q=function(e){C(Object(k.a)(Object(k.a)({},S),{},{questions:S.questions.map((function(t,n){return n===parseInt(e.target.dataset.name)?Object(k.a)(Object(k.a)({},t),{},{question:e.target.value}):t}))}))},U=function(e){C(Object(k.a)(Object(k.a)({},S),{},Object(j.a)({},e.target.dataset.name,e.target.value)))},y=function(){C({set_start_at:g,set_publish_at:g,channel_id:null,user_bot_id:s.id,questions:m})},w=S.questions.filter((function(e){return""===e.question.trim()})).length===S.questions.length||null===S.channel_id;return b.a.createElement(B,null,s&&b.a.createElement("div",{className:"card-body"},b.a.createElement("h4",{className:"mb-3"},n.huddleLabel),b.a.createElement("div",{className:"mb-2"},b.a.createElement("label",null,n.channels),b.a.createElement(x.d,{options:I,value:O,onChange:function(e){if(null===e)L([]),C(Object(k.a)(Object(k.a)({},S),{},{set_start_at:g,set_publish_at:g,channel_id:null,user_bot_id:s.id,questions:m}));else if(L(e),e.huddle){var t=parseInt(e.huddle.publish_at.time.substr(0,2))-_,n=parseInt(e.huddle.start_at.time.substr(0,2))-_;C(Object(k.a)(Object(k.a)({},S),{},{introduction_message:e.huddle.introduction_message,closing_message:e.huddle.closing_message,channel_id:e.value,questions:e.huddle.questions,user_bot_id:s.id,set_publish_at:Q(t>23?24-t:t)+":"+e.huddle.publish_at.time.substr(3,2),set_start_at:Q(n>23?24-n:n)+":"+e.huddle.start_at.time.substr(3,2)}))}else C(Object(k.a)(Object(k.a)({},S),{},{channel_id:e.value,questions:m}))},isMulti:!1,isClearable:!0})),b.a.createElement("div",{className:"mb-2"},b.a.createElement("label",null,n.startAt),b.a.createElement("br",null),b.a.createElement(G,{className:"react-datetime-picker start_at",onChange:function(e){C(Object(k.a)(Object(k.a)({},S),{},{set_start_at:e}))},value:S.set_start_at,disableClock:!0})),b.a.createElement("div",{className:"mb-2"},b.a.createElement("label",null,n.publishAt),b.a.createElement("br",null),b.a.createElement(G,{className:"react-datetime-picker publish_at",onChange:function(e){C(Object(k.a)(Object(k.a)({},S),{},{set_publish_at:e}))},value:S.set_publish_at,disableClock:!0})),b.a.createElement("div",{className:"mb-2"},b.a.createElement("label",null,"Welcome message"),b.a.createElement("div",{className:"mb-2"},b.a.createElement("div",{className:"input-group"},b.a.createElement("input",{onChange:U,"data-name":"introduction_message",type:"text",className:"form-control",placeholder:"Welcome message","aria-describedby":"button-addon1",autoFocus:!0,value:S.introduction_message})))),b.a.createElement("div",{className:"mb-2"},b.a.createElement("label",null,"Thank you message"),b.a.createElement("div",{className:"mb-2"},b.a.createElement("div",{className:"input-group"},b.a.createElement("input",{onChange:U,"data-name":"closing_message",type:"text",className:"form-control",placeholder:"Thank you message","aria-describedby":"button-addon1",autoFocus:!0,value:S.closing_message})))),b.a.createElement("div",{className:"mb-2"},b.a.createElement("label",null,n.questions),S.questions.map((function(e,t){return b.a.createElement("div",{className:"mb-2",key:t},b.a.createElement("div",{className:"input-group"},b.a.createElement("input",{onChange:q,"data-name":t,type:"text",className:"form-control",placeholder:"Question","aria-describedby":"button-addon1",autoFocus:!0,value:e.question})))})),b.a.createElement("button",{className:"btn btn-primary",onClick:function(){var e=parseInt(S.set_publish_at.substr(0,2))+_,t=parseInt(S.set_start_at.substr(0,2))+_,i=S.set_publish_at.substr(3,2),c=S.set_start_at.substr(3,2),r=Object(k.a)(Object(k.a)({},S),{},{questions:S.questions.filter((function(e){return""!==e.question.trim()})),user_bot_id:s.id,set_publish_at:Q(e>=0?e:24+e)+":"+i,set_start_at:Q(t>=0?t:24+t)+":"+c}),o=function(e,t){e?l.error(n.huddleBotFailed):(O.huddle?l.success(n.huddleBotUpdated):l.success(n.huddleBotCreated),y(),L([]))};O.huddle?(r=Object(k.a)(Object(k.a)({},r),{},{huddle_id:O.huddle.id,update_questions:r.questions,new_questions:[],remove_question_ids:[]}),a.update(r,o)):a.create(r,o)},disabled:w},O.huddle?n.update:n.create),O.huddle&&b.a.createElement("button",{className:"btn btn-primary ml-3",onClick:function(){var e=function(e,t){e||(y(),L([]))},t={type:"confirmation",headerText:n.deleteHuddle,submitText:n.delete,cancelText:n.cancel,bodyText:n.confirmationText,actions:{onSubmit:function(){return a.remove({huddle_id:O.huddle.id},e)}}};i(Object(H.a)(t))},disabled:w},n.delete))))},K=p.a.div(o||(o=Object(m.a)(["\n  overflow: visible !important;\n  height: 100%;\n"]))),P=function(e){return b.a.createElement(K,{className:"card"},b.a.createElement(g.d,null,b.a.createElement(g.b,Object.assign({},e,{component:S,path:["/admin-settings/settings"]})),b.a.createElement(g.b,Object.assign({},e,{component:y,path:["/admin-settings/quick-links"]})),b.a.createElement(g.b,Object.assign({},e,{component:F,path:["/admin-settings/bots"]})),b.a.createElement(g.a,{from:"*",to:{pathname:"/admin-settings/settings"}})))},R=p.a.div(u||(u=Object(m.a)(["\n  overflow: hidden auto;\n  .app-block {\n    overflow: inherit;\n    .app-content {\n      height: auto;\n    }\n  }\n"])));t.default=function(e){return b.a.createElement(R,{className:"container-fluid h-100 fadeIn"},b.a.createElement("div",{className:"row app-block"},b.a.createElement(O,null),b.a.createElement("div",{className:"col-lg-9 app-content mb-4"},b.a.createElement("div",{className:"app-content-overlay"}),b.a.createElement(P,null))))}}}]);