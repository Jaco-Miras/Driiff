(this.webpackJsonpdriff=this.webpackJsonpdriff||[]).push([[13],{626:function(e,n,t){e.exports=t.p+"static/media/text.bf6e5a52.svg"},682:function(e,n,t){},724:function(e,n,t){"use strict";t.r(n);var a,i,r,c,o,l,s,d,f,m,u,p,g=t(0),h=t(11),b=t(9),v=t(1),w=t.n(v),x=t(5),j=t(10),y=t(29),O=t(20),E=(t(682),t(12)),k=t(65),_=t(49),N=j.a.div(a||(a=Object(b.a)(["\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  pointer-events: auto;\n  align-items: center;\n  justify-content: space-evenly;\n  font-size: 2.5rem;\n  color: #fff;\n  z-index: 9999;\n  .fas {\n    cursor: pointer;\n  }\n  .cannot-preview {\n    min-width: 40vw;\n    min-height: 40vh;\n    padding: 20px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    color: #cccccc;\n    text-align: center;\n    p {\n      font-size: 1.1rem;\n      line-height: 1.4rem;\n      margin: 2rem 0 1.5rem 0;\n    }\n    svg {\n      width: 48px;\n      height: 48px;\n    }\n  }\n  .iframe.file {\n    min-width: 80vw;\n    min-height: 80vh;\n  }\n"]))),L=Object(j.a)(k.c)(i||(i=Object(b.a)(["\n  position: relative;\n  top: -3px;\n  margin-right: 5px;\n"]))),T=Object(j.a)(k.c)(r||(r=Object(b.a)([""]))),S=j.a.p(c||(c=Object(b.a)(["\n  display: block;\n  text-align: left;\n  margin-bottom: 0;\n"]))),F=j.a.span(o||(o=Object(b.a)(["\n  position: relative;\n  z-index: 1;\n  display: inline-block;\n  font-size: 16px;\n  font-weight: 500;\n  margin: 0;\n  color: #fff;\n\n  &:hover {\n    text-decoration: none;\n    color: #fff;\n    cursor: pointer;\n  }\n"]))),C=j.a.p(l||(l=Object(b.a)(["\n  width: 100%;\n  display: block;\n  font-size: 11px;\n  font-weight: normal;\n  text-align: left;\n  margin: 0;\n"]))),z=j.a.div(s||(s=Object(b.a)(['\n  position: relative;\n  top: 0;\n  margin: 0 auto;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  background-color: rgba(24, 24, 26, 0.5);\n\n  :before {\n    background-color: rgba(0, 0, 0, 0.8);\n    opacity: 0.5;\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    content: "";\n    display: block;\n    z-index: -1;\n  }\n\n  .iframe {\n    width: 100%;\n    height: 100%;\n    display: block;\n    margin-left: auto;\n    margin-right: auto;\n  }\n  .mfp-container {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  .mfp-content {\n    margin-top: -20px;\n\n    .mfp-close {\n      position: relative;\n      width: 22px;\n    }\n  }\n  .mfp-figure {\n    &::after {\n      top: 58px;\n      bottom: 0;\n    }\n  }\n  .mfp-bottom-bar {\n    margin-top: 0;\n  }\n']))),D=j.a.div(d||(d=Object(b.a)(["\n  position: relative;\n"]))),P=j.a.button(f||(f=Object(b.a)(["\n  &:focus {\n    outline: none;\n  }\n"]))),R=j.a.button(m||(m=Object(b.a)(["\n  opacity: ",";\n  visibility: ",";\n\n  &:focus {\n    outline: none;\n  }\n"])),(function(e){return e.show?"1":"0"}),(function(e){return e.show?"visible":"hidden"})),I=j.a.figure(u||(u=Object(b.a)(["\n  box-sizing: border-box;\n  padding: 0;\n  margin: 0 auto;\n  img {\n    max-width: 100%;\n    max-height: 80vh;\n  }\n"]))),A=j.a.div(p||(p=Object(b.a)(["\n  text-align: center;\n\n  .spinner-border {\n    border-width: 3px;\n    padding: 10px;\n    margin: 5px;\n  }\n  .file {\n    margin: 0 auto;\n    transition: all 0.5s ease;\n    opacity: 1;\n    max-height: 80vh;\n    max-width: 100%;\n\n    &:not([src]) {\n      opacity: 0;\n      max-height: 0;\n    }\n    &[src] {\n      ","\n    }\n\n    &.file-pdf {\n      &:not([data]) {\n        opacity: 0;\n        max-height: 0;\n      }\n      &[data] {\n        ","\n      }\n    }\n  }\n"])),(function(e){return e.isLoaded?"\n        opacity: 1;\n        max-height: 80vh;      \n      ":"\n        opacity: 0;\n        max-height: 0;\n      "}),(function(e){return e.isLoaded?"\n          max-width: 1060px;\n          max-height: 100%;\n          opacity: 1;\n        ":"\n          opacity: 0;\n          max-height: 0;\n        "})),U=function(e){var n=e.className,a=void 0===n?"":n,i=e.file,r=e.setFiles,c=e.files,o=e.viewFiles,l=Object(x.c)(),s=Object(E.hb)(),d=Object(E.s)(),f=d.fileBlobs,m=d.actions.setFileSrc,u=Object(v.useState)(!1),p=Object(h.a)(u,2),b=p[0],j=p[1],k={};Object(v.useEffect)((function(){f[i.id]?j(!0):(j(!1),_.sessionService.loadSession().then((function(e){var n=e.token;fetch(i.view_link,{method:"GET",keepalive:!0,headers:{Authorization:n,"Access-Control-Allow-Origin":"*",Connection:"keep-alive",crossorigin:!0}}).then((function(e){return e.blob()})).then((function(e){var n=URL.createObjectURL(e);r(c.map((function(e){return e.id===i.id?Object(g.a)(Object(g.a)({},e),{},{imgSrc:n}):e}))),m({id:i.id,src:n},(function(){j(!0)}))}))})))}),[i]);var N=i.type.toLowerCase();return N.includes("video")?w.a.createElement(A,{isLoaded:b,key:i.id,"data-index":i.id,className:"file-item mfp-img ".concat(a)},b?w.a.createElement(w.a.Fragment,null,w.a.createElement("img",{className:"d-none",src:t(626),alt:"File not found."}),w.a.createElement("video",{className:"file opacity-0","data-index":i.id,"data-attempt":0,ref:function(e){return k[i.id]=e},controls:!0,playsInline:!0,key:i.id,autoPlay:!1,onLoadStart:function(e){e.currentTarget.classList.remove("d-none"),e.currentTarget.removeAttribute("height")},onError:function(e){"0"===e.currentTarget.dataset.attempt?(e.currentTarget.dataset.attempt=1,e.currentTarget.src="".concat(Object(y.a)({isDNS:!0}),"/file-view-attempt/").concat(i.file_id,"/").concat(localStorage.getItem("atoken"))):(document.querySelector('.file-item[data-index="'.concat(e.currentTarget.dataset.index,'"] img')).classList.remove("d-none"),document.querySelector('.file-item[data-index="'.concat(e.currentTarget.dataset.index,'"] video')).classList.add("d-none"))},src:f[i.id]})):w.a.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):"image"===N?w.a.createElement(A,{isLoaded:b,key:i.id,"data-index":i.id,className:"file-item mfp-img ".concat(a)},b?w.a.createElement(w.a.Fragment,null,w.a.createElement("img",{className:"file","data-index":i.id,"data-attempt":0,onError:function(e){"0"===e.currentTarget.dataset.attempt?(e.currentTarget.dataset.attempt=1,e.currentTarget.src="".concat(Object(y.a)({isDNS:!0}),"/file-view-attempt/").concat(i.file_id,"/").concat(localStorage.getItem("atoken"))):"1"===e.currentTarget.dataset.attemp?(e.currentTarget.dataset.attempt=2,e.currentTarget.src="".concat(e.currentTarget.src,"&timestamp=").concat((new Date).getTime())):(e.currentTarget.classList.add("img-error"),e.currentTarget.src=t(626))},ref:function(e){return k[i.id]=e},key:i.id,src:f[i.id],alt:i.filename?i.filename:i.search})):w.a.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):"pdf"===N?w.a.createElement(A,{isLoaded:b,key:i.id,"data-index":i.id,className:"file-item mfp-img ".concat(a)},b?w.a.createElement(w.a.Fragment,null,w.a.createElement("object",{className:"file file-pdf",data:f[i.id],width:.9*s.width,height:s.height-122,onLoad:function(e){}},w.a.createElement("embed",{src:f[i.id],width:"600",height:"400"}))):w.a.createElement("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"})):w.a.createElement(A,{isLoaded:b,key:i.id,"data-index":i.id,className:"file-item mfp-img cannot-preview ".concat(a)},w.a.createElement(T,{icon:"eye-off"}),w.a.createElement("p",null,i.search?i.search:i.filename,"We can't preview this file type. ",w.a.createElement("br",null),"Try downloading the file to view it."),w.a.createElement("button",{className:"btn btn-primary",onClick:function(e){return function(e,n){if(n.remove_on_download){var t={file_id:n.file_id};o.topic_id&&(t=Object(g.a)(Object(g.a)({},t),{},{topic_id:o.topic_id})),l(Object(O.Rb)(t))}e.preventDefault(),window.open(n.download_link,"_self").blur(),window.focus()}(e,i)}},"Download ",i.search))};n.default=w.a.memo((function(e){var n=e.className,t=void 0===n?"":n,a=Object(v.useRef)(),i=Object(x.c)(),r=Object(x.d)((function(e){return e.files.channelFiles})),c=Object(x.d)((function(e){return e.files.viewFiles})),o=Object(x.d)((function(e){return e.files.workspaceFiles})),l=Object(E.V)().localizeDate,s=Object(v.useState)(0),d=Object(h.a)(s,2),f=d[0],m=d[1],u=Object(v.useState)([]),p=Object(h.a)(u,2),b=p[0],j=p[1],y=function(){var e=b.length;m(e-1===f?0:f+1)},k=function(){var e=b.length;m(0===f?e-1:f-1)},_=function(e){e.preventDefault(),e.stopPropagation(),i(Object(O.Ub)(null))};Object(v.useEffect)((function(){if(Object.keys(r).length&&r.hasOwnProperty(c.channel_id))j(r[c.channel_id]),r[c.channel_id].forEach((function(e,n){e.file_id===c.file_id&&m(n)}));else if(Object.keys(o).length&&o.hasOwnProperty(c.workspace_id)){var e=Object.values(o[c.workspace_id].files);c.hasOwnProperty("files")&&(e=c.files),j(e),m(e.findIndex((function(e){return e.id===c.file_id})))}else c.files&&c.files.length&&(j(c.files),m(c.files.findIndex((function(e){return e.file_id===c.file_id}))))}),[]),Object(v.useEffect)((function(){if(a.current){var e=function(e){switch(e.keyCode){case 27:_(e);break;case 39:y();break;case 37:k();break;default:return null}};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}}),[a]),Object(E.E)(a,(function(){i(Object(O.Ub)(null))}),!0);var T=b[f];if(0!==b.length&&null!==f&&"undefined"!==typeof T)return w.a.createElement(N,{className:"fileviewer-container ".concat(t),"data-file-index":f},w.a.createElement(z,{className:"iframe-img-container"},w.a.createElement("div",{className:"mfp-container mfp-s-ready mfp-image-holder"},w.a.createElement("div",{ref:a},w.a.createElement("div",{className:"mfp-content"},w.a.createElement("div",{className:"d-flex justify-content-between align-items-start"},w.a.createElement(D,null,w.a.createElement(S,null,w.a.createElement(F,{onClick:function(e){return function(e,n){if(n.remove_on_download){var t={file_id:n.file_id};c.topic_id&&(t=Object(g.a)(Object(g.a)({},t),{},{topic_id:c.topic_id})),i(Object(O.Rb)(t))}e.preventDefault(),window.open(n.download_link,"_self").blur(),window.focus()}(e,T)}},w.a.createElement(L,{icon:"download"})," ",T.filename?T.filename:T.search)),T.created_at&&T.created_at.timestamp&&w.a.createElement(C,null,l(T.created_at.timestamp)," \u25cf ",T.type.toLowerCase())),w.a.createElement(P,{onClick:function(e){return _(e)},title:"Close (Esc)",type:"button",className:"mfp-close"},"\xd7")),w.a.createElement("div",{className:"mfp-figure"},w.a.createElement(I,null,w.a.createElement(U,{files:b,file:b[f],setFiles:j,viewFiles:c}),w.a.createElement("figcaption",null,w.a.createElement("div",{className:"mfp-bottom-bar"},w.a.createElement("div",{className:"mfp-title"}),w.a.createElement("div",{className:"mfp-counter"},"".concat(f+1," of ").concat(b.length))))))),w.a.createElement("div",{className:"mfp-preloader"},"Loading..."),w.a.createElement(R,{show:b.length>1,onClick:function(e){return k()},title:"Previous (Left arrow key)",type:"button",className:"mfp-arrow mfp-arrow-left mfp-prevent-close"}),w.a.createElement(R,{show:b.length>1,onClick:function(e){return y()},title:"Next (Right arrow key)",type:"button",className:"mfp-arrow mfp-arrow-right mfp-prevent-close"})))))}))}}]);